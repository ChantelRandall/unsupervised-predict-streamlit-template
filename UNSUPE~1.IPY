{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "ba814213",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: scikit-surprise in c:\\users\\w7043565\\appdata\\local\\anaconda3\\lib\\site-packages (1.1.3)\n",
      "Requirement already satisfied: joblib>=1.0.0 in c:\\users\\w7043565\\appdata\\local\\anaconda3\\lib\\site-packages (from scikit-surprise) (1.3.2)\n",
      "Requirement already satisfied: numpy>=1.17.3 in c:\\users\\w7043565\\appdata\\local\\anaconda3\\lib\\site-packages (from scikit-surprise) (1.24.4)\n",
      "Requirement already satisfied: scipy>=1.3.2 in c:\\users\\w7043565\\appdata\\local\\anaconda3\\lib\\site-packages (from scikit-surprise) (1.10.1)\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import pickle\n",
    "import copy\n",
    "\n",
    "!pip install scikit-surprise\n",
    "from surprise import Reader, Dataset\n",
    "from surprise import SVD, NormalPredictor, BaselineOnly, KNNBasic, NMF\n",
    "from sklearn.metrics.pairwise import cosine_similarity\n",
    "from sklearn.feature_extraction.text import CountVectorizer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "d0e101a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_df = pd.read_csv('train.csv') # ratings\n",
    "test_df = pd.read_csv('test.csv')\n",
    "tags_df = pd.read_csv('tags.csv')\n",
    "genome_scores_df = pd.read_csv('genome_scores.csv')\n",
    "genome_tags_df = pd.read_csv('genome_tags.csv')\n",
    "imdb_data_df = pd.read_csv('imdb_data.csv')\n",
    "links_df = pd.read_csv('links.csv')\n",
    "movies_df = pd.read_csv('movies.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "5b057091",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0               1_2011\n",
       "1               1_4144\n",
       "2               1_5767\n",
       "3               1_6711\n",
       "4               1_7318\n",
       "              ...     \n",
       "5000014    162541_4079\n",
       "5000015    162541_4467\n",
       "5000016    162541_4980\n",
       "5000017    162541_5689\n",
       "5000018    162541_7153\n",
       "Name: Id, Length: 5000019, dtype: object"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_df['Id']= test_df['userId'].astype(str) + '_' + test_df['movieId'].astype(str)\n",
    "test_df['Id']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "64c53a81",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_df['Id'].isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "721c0965",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(10000038, 4)"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "0c66d306",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>5163</td>\n",
       "      <td>57669</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1518349992</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>106343</td>\n",
       "      <td>5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1206238739</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>146790</td>\n",
       "      <td>5459</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1076215539</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>106362</td>\n",
       "      <td>32296</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1423042565</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>9041</td>\n",
       "      <td>366</td>\n",
       "      <td>3.0</td>\n",
       "      <td>833375837</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   userId  movieId  rating   timestamp\n",
       "0    5163    57669     4.0  1518349992\n",
       "1  106343        5     4.5  1206238739\n",
       "2  146790     5459     5.0  1076215539\n",
       "3  106362    32296     2.0  1423042565\n",
       "4    9041      366     3.0   833375837"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "f0e98834",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "userId       0\n",
       "movieId      0\n",
       "rating       0\n",
       "timestamp    0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "6fac568f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "userId         int64\n",
       "movieId        int64\n",
       "rating       float64\n",
       "timestamp      int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "d794e44d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(5000019, 3)"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "708a26fa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>Id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>1_2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>4144</td>\n",
       "      <td>1_4144</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>5767</td>\n",
       "      <td>1_5767</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>6711</td>\n",
       "      <td>1_6711</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>7318</td>\n",
       "      <td>1_7318</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   userId  movieId      Id\n",
       "0       1     2011  1_2011\n",
       "1       1     4144  1_4144\n",
       "2       1     5767  1_5767\n",
       "3       1     6711  1_6711\n",
       "4       1     7318  1_7318"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "0b649adb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "userId      int64\n",
       "movieId     int64\n",
       "Id         object\n",
       "dtype: object"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "7023a653",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1093360, 4)"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tags_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "0acc1188",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>tag</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>3</td>\n",
       "      <td>260</td>\n",
       "      <td>classic</td>\n",
       "      <td>1439472355</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3</td>\n",
       "      <td>260</td>\n",
       "      <td>sci-fi</td>\n",
       "      <td>1439472256</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4</td>\n",
       "      <td>1732</td>\n",
       "      <td>dark comedy</td>\n",
       "      <td>1573943598</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>1732</td>\n",
       "      <td>great dialogue</td>\n",
       "      <td>1573943604</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>7569</td>\n",
       "      <td>so bad it's good</td>\n",
       "      <td>1573943455</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   userId  movieId               tag   timestamp\n",
       "0       3      260           classic  1439472355\n",
       "1       3      260            sci-fi  1439472256\n",
       "2       4     1732       dark comedy  1573943598\n",
       "3       4     1732    great dialogue  1573943604\n",
       "4       4     7569  so bad it's good  1573943455"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tags_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "7eb497c1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(15584448, 3)"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "genome_scores_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "d3671ab8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>tagId</th>\n",
       "      <th>relevance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.02875</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0.02375</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0.06250</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>0.07575</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>0.14075</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   movieId  tagId  relevance\n",
       "0        1      1    0.02875\n",
       "1        1      2    0.02375\n",
       "2        1      3    0.06250\n",
       "3        1      4    0.07575\n",
       "4        1      5    0.14075"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "genome_scores_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "0fe1b34c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1128, 2)"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "genome_tags_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "a81bd2ca",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tagId</th>\n",
       "      <th>tag</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>007</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>007 (series)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>18th century</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>1920s</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>1930s</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   tagId           tag\n",
       "0      1           007\n",
       "1      2  007 (series)\n",
       "2      3  18th century\n",
       "3      4         1920s\n",
       "4      5         1930s"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "genome_tags_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "ee06b6f0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(27278, 6)"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imdb_data_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "4a259925",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title_cast</th>\n",
       "      <th>director</th>\n",
       "      <th>runtime</th>\n",
       "      <th>budget</th>\n",
       "      <th>plot_keywords</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Tom Hanks|Tim Allen|Don Rickles|Jim Varney|Wal...</td>\n",
       "      <td>John Lasseter</td>\n",
       "      <td>81.0</td>\n",
       "      <td>$30,000,000</td>\n",
       "      <td>toy|rivalry|cowboy|cgi animation</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Robin Williams|Jonathan Hyde|Kirsten Dunst|Bra...</td>\n",
       "      <td>Jonathan Hensleigh</td>\n",
       "      <td>104.0</td>\n",
       "      <td>$65,000,000</td>\n",
       "      <td>board game|adventurer|fight|game</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Walter Matthau|Jack Lemmon|Sophia Loren|Ann-Ma...</td>\n",
       "      <td>Mark Steven Johnson</td>\n",
       "      <td>101.0</td>\n",
       "      <td>$25,000,000</td>\n",
       "      <td>boat|lake|neighbor|rivalry</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Whitney Houston|Angela Bassett|Loretta Devine|...</td>\n",
       "      <td>Terry McMillan</td>\n",
       "      <td>124.0</td>\n",
       "      <td>$16,000,000</td>\n",
       "      <td>black american|husband wife relationship|betra...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Steve Martin|Diane Keaton|Martin Short|Kimberl...</td>\n",
       "      <td>Albert Hackett</td>\n",
       "      <td>106.0</td>\n",
       "      <td>$30,000,000</td>\n",
       "      <td>fatherhood|doberman|dog|mansion</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   movieId                                         title_cast  \\\n",
       "0        1  Tom Hanks|Tim Allen|Don Rickles|Jim Varney|Wal...   \n",
       "1        2  Robin Williams|Jonathan Hyde|Kirsten Dunst|Bra...   \n",
       "2        3  Walter Matthau|Jack Lemmon|Sophia Loren|Ann-Ma...   \n",
       "3        4  Whitney Houston|Angela Bassett|Loretta Devine|...   \n",
       "4        5  Steve Martin|Diane Keaton|Martin Short|Kimberl...   \n",
       "\n",
       "              director  runtime       budget  \\\n",
       "0        John Lasseter     81.0  $30,000,000   \n",
       "1   Jonathan Hensleigh    104.0  $65,000,000   \n",
       "2  Mark Steven Johnson    101.0  $25,000,000   \n",
       "3       Terry McMillan    124.0  $16,000,000   \n",
       "4       Albert Hackett    106.0  $30,000,000   \n",
       "\n",
       "                                       plot_keywords  \n",
       "0                   toy|rivalry|cowboy|cgi animation  \n",
       "1                   board game|adventurer|fight|game  \n",
       "2                         boat|lake|neighbor|rivalry  \n",
       "3  black american|husband wife relationship|betra...  \n",
       "4                    fatherhood|doberman|dog|mansion  "
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imdb_data_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "a056ac1d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(62423, 3)"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "links_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "b0047d7f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>imdbId</th>\n",
       "      <th>tmdbId</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>114709</td>\n",
       "      <td>862.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>113497</td>\n",
       "      <td>8844.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>113228</td>\n",
       "      <td>15602.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>114885</td>\n",
       "      <td>31357.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>113041</td>\n",
       "      <td>11862.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   movieId  imdbId   tmdbId\n",
       "0        1  114709    862.0\n",
       "1        2  113497   8844.0\n",
       "2        3  113228  15602.0\n",
       "3        4  114885  31357.0\n",
       "4        5  113041  11862.0"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "links_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "69716a81",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(62423, 3)"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "396d8d38",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Toy Story (1995)</td>\n",
       "      <td>Adventure|Animation|Children|Comedy|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jumanji (1995)</td>\n",
       "      <td>Adventure|Children|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Grumpier Old Men (1995)</td>\n",
       "      <td>Comedy|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Waiting to Exhale (1995)</td>\n",
       "      <td>Comedy|Drama|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Father of the Bride Part II (1995)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   movieId                               title  \\\n",
       "0        1                    Toy Story (1995)   \n",
       "1        2                      Jumanji (1995)   \n",
       "2        3             Grumpier Old Men (1995)   \n",
       "3        4            Waiting to Exhale (1995)   \n",
       "4        5  Father of the Bride Part II (1995)   \n",
       "\n",
       "                                        genres  \n",
       "0  Adventure|Animation|Children|Comedy|Fantasy  \n",
       "1                   Adventure|Children|Fantasy  \n",
       "2                               Comedy|Romance  \n",
       "3                         Comedy|Drama|Romance  \n",
       "4                                       Comedy  "
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "e559ca45",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>weighted_average</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>movieId</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>318</th>\n",
       "      <td>32831</td>\n",
       "      <td>4.417624</td>\n",
       "      <td>4.410888</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>858</th>\n",
       "      <td>20960</td>\n",
       "      <td>4.311355</td>\n",
       "      <td>4.302113</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>22032</td>\n",
       "      <td>4.278073</td>\n",
       "      <td>4.269652</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1221</th>\n",
       "      <td>13525</td>\n",
       "      <td>4.274085</td>\n",
       "      <td>4.260537</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>527</th>\n",
       "      <td>24004</td>\n",
       "      <td>4.247625</td>\n",
       "      <td>4.240205</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>5461</td>\n",
       "      <td>4.261399</td>\n",
       "      <td>4.229287</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1203</th>\n",
       "      <td>6594</td>\n",
       "      <td>4.252351</td>\n",
       "      <td>4.225886</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>904</th>\n",
       "      <td>8160</td>\n",
       "      <td>4.242034</td>\n",
       "      <td>4.220805</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2959</th>\n",
       "      <td>23536</td>\n",
       "      <td>4.227906</td>\n",
       "      <td>4.220549</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>159817</th>\n",
       "      <td>674</td>\n",
       "      <td>4.473294</td>\n",
       "      <td>4.217511</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         count      mean  weighted_average\n",
       "movieId                                   \n",
       "318      32831  4.417624          4.410888\n",
       "858      20960  4.311355          4.302113\n",
       "50       22032  4.278073          4.269652\n",
       "1221     13525  4.274085          4.260537\n",
       "527      24004  4.247625          4.240205\n",
       "2019      5461  4.261399          4.229287\n",
       "1203      6594  4.252351          4.225886\n",
       "904       8160  4.242034          4.220805\n",
       "2959     23536  4.227906          4.220549\n",
       "159817     674  4.473294          4.217511"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Calculate the mean rating of all movies\n",
    "C = train_df['rating'].mean()\n",
    "\n",
    "# Calculate the 90th percentile of the number of ratings\n",
    "m = train_df.groupby('movieId')['rating'].count().quantile(0.9)\n",
    "\n",
    "# Group the dataframe by title and get the count and mean of ratings\n",
    "ratings = train_df.groupby('movieId')['rating'].agg(['count', 'mean'])\n",
    "\n",
    "# Define a function to calculate the weighted average\n",
    "def weighted_average(x, m=m, C=C):\n",
    "    v = x['count']\n",
    "    R = x['mean']\n",
    "    return (v/(v+m) * R) + (m/(m+v) * C)\n",
    "\n",
    "# Apply the function to the ratings dataframe and create a new column\n",
    "ratings['weighted_average'] = ratings.apply(weighted_average, axis=1)\n",
    "\n",
    "# Sort the ratings dataframe by weighted average in descending order\n",
    "ratings = ratings.sort_values('weighted_average', ascending=False)\n",
    "\n",
    "# Display the top 10 movies by weighted average\n",
    "ratings.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "86ab165a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Collaborative filtering"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "2a204224",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Evaluating RMSE, MAE of algorithm SVDpp on 5 split(s).\n",
      "\n",
      "                  Fold 1  Fold 2  Fold 3  Fold 4  Fold 5  Mean    Std     \n",
      "RMSE (testset)    0.9835  0.9723  0.9738  0.9722  0.9755  0.9754  0.0042  \n",
      "MAE (testset)     0.7669  0.7541  0.7594  0.7575  0.7575  0.7591  0.0043  \n",
      "Fit time          1.19    1.26    1.40    1.46    1.57    1.38    0.14    \n",
      "Test time         0.30    0.41    0.46    0.44    0.30    0.38    0.07    \n",
      "RMSE: 0.9801\n",
      "RMSE:  0.9800731505697814\n"
     ]
    }
   ],
   "source": [
    "# SVD++\n",
    "from surprise import accuracy\n",
    "from surprise.model_selection import train_test_split\n",
    "from surprise import SVDpp \n",
    "from surprise import Dataset \n",
    "from surprise.model_selection import cross_validate\n",
    "\n",
    "train_df.drop('timestamp', axis=1, inplace=True)\n",
    "\n",
    "# Load and preprocess data\n",
    "train_subset = train_df[:100000]\n",
    "\n",
    "# Define the format\n",
    "reader = Reader(rating_scale=(0.5, 5))\n",
    "\n",
    "# Load the data into the surprise format\n",
    "data = Dataset.load_from_df(train_subset[['userId', 'movieId', 'rating']], reader)\n",
    "\n",
    "\n",
    "# Split the data into training and testing sets\n",
    "trainset, testset = train_test_split(data, test_size=.30, random_state=48)\n",
    "\n",
    "# Build the model\n",
    "algo = SVDpp()\n",
    "\n",
    "cross_validate(algo, data, measures=['RMSE', 'MAE'], cv=5, verbose=True)\n",
    "\n",
    "# Train the model\n",
    "algo.fit(trainset)\n",
    "\n",
    "# Make predictions on the test data\n",
    "predictions = algo.test(testset)\n",
    "\n",
    "# Evaluate the model using RMSE\n",
    "rmse = accuracy.rmse(predictions) # compute the RMSE\n",
    "print('RMSE: ', rmse) # print the RMSE\n",
    "\n",
    "# Report the RMSE to NNI\n",
    "# nni.report_final_result(rmse)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "f7516136",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Prediction(uid=72210, iid=4361, r_ui=2.0, est=3.114892352391608, details={'was_impossible': False}),\n",
       " Prediction(uid=38912, iid=6365, r_ui=3.5, est=3.405543391699307, details={'was_impossible': False}),\n",
       " Prediction(uid=95080, iid=1200, r_ui=5.0, est=3.999951855382467, details={'was_impossible': False}),\n",
       " Prediction(uid=52199, iid=48, r_ui=4.0, est=3.175965525620829, details={'was_impossible': False}),\n",
       " Prediction(uid=78421, iid=122, r_ui=3.0, est=3.149097025151338, details={'was_impossible': False}),\n",
       " Prediction(uid=92673, iid=3994, r_ui=5.0, est=3.8507860381143235, details={'was_impossible': False}),\n",
       " Prediction(uid=112346, iid=1246, r_ui=4.0, est=4.070209874234808, details={'was_impossible': False}),\n",
       " Prediction(uid=109836, iid=2542, r_ui=5.0, est=3.8079876021711967, details={'was_impossible': False}),\n",
       " Prediction(uid=17016, iid=148626, r_ui=4.0, est=3.8958347285980337, details={'was_impossible': False}),\n",
       " Prediction(uid=93117, iid=109569, r_ui=4.0, est=3.5881280771217754, details={'was_impossible': False}),\n",
       " Prediction(uid=1729, iid=1682, r_ui=4.5, est=3.557339408730307, details={'was_impossible': False}),\n",
       " Prediction(uid=94752, iid=312, r_ui=2.0, est=3.4061115216589184, details={'was_impossible': False}),\n",
       " Prediction(uid=89258, iid=55052, r_ui=3.0, est=3.577121533360757, details={'was_impossible': False}),\n",
       " Prediction(uid=134954, iid=72998, r_ui=5.0, est=3.631862275426247, details={'was_impossible': False}),\n",
       " Prediction(uid=23658, iid=1374, r_ui=3.5, est=3.260680814495368, details={'was_impossible': False}),\n",
       " Prediction(uid=77602, iid=1220, r_ui=3.5, est=3.7282097599601762, details={'was_impossible': False}),\n",
       " Prediction(uid=55183, iid=631, r_ui=2.0, est=2.9185988329473487, details={'was_impossible': False}),\n",
       " Prediction(uid=64556, iid=1036, r_ui=4.0, est=3.9974323566474186, details={'was_impossible': False}),\n",
       " Prediction(uid=95272, iid=912, r_ui=4.0, est=4.026289449506924, details={'was_impossible': False}),\n",
       " Prediction(uid=141388, iid=56587, r_ui=4.5, est=4.195603514284639, details={'was_impossible': False}),\n",
       " Prediction(uid=38158, iid=3677, r_ui=4.0, est=4.003860205046199, details={'was_impossible': False}),\n",
       " Prediction(uid=55185, iid=74458, r_ui=3.5, est=3.8877211802177634, details={'was_impossible': False}),\n",
       " Prediction(uid=11719, iid=55363, r_ui=3.0, est=3.546233297249724, details={'was_impossible': False}),\n",
       " Prediction(uid=69580, iid=48780, r_ui=5.0, est=3.6130308598143657, details={'was_impossible': False}),\n",
       " Prediction(uid=52624, iid=2406, r_ui=5.0, est=3.6610660283373417, details={'was_impossible': False}),\n",
       " Prediction(uid=138130, iid=85213, r_ui=3.0, est=3.652173533828008, details={'was_impossible': False}),\n",
       " Prediction(uid=145321, iid=93840, r_ui=4.5, est=3.8752902085396044, details={'was_impossible': False}),\n",
       " Prediction(uid=46857, iid=588, r_ui=5.0, est=3.8172114988478656, details={'was_impossible': False}),\n",
       " Prediction(uid=91630, iid=908, r_ui=4.0, est=3.896692471710237, details={'was_impossible': False}),\n",
       " Prediction(uid=128800, iid=318, r_ui=5.0, est=4.28323419495754, details={'was_impossible': False}),\n",
       " Prediction(uid=5231, iid=2002, r_ui=3.0, est=3.60273920154076, details={'was_impossible': False}),\n",
       " Prediction(uid=141223, iid=59022, r_ui=3.5, est=3.6716972647151094, details={'was_impossible': False}),\n",
       " Prediction(uid=82042, iid=112623, r_ui=2.5, est=3.540305012785613, details={'was_impossible': False}),\n",
       " Prediction(uid=72914, iid=2641, r_ui=3.0, est=3.030772009956218, details={'was_impossible': False}),\n",
       " Prediction(uid=24017, iid=2353, r_ui=5.0, est=3.6017560739754755, details={'was_impossible': False}),\n",
       " Prediction(uid=77071, iid=1270, r_ui=3.5, est=3.806830792065901, details={'was_impossible': False}),\n",
       " Prediction(uid=13961, iid=88125, r_ui=3.0, est=3.3947725712781165, details={'was_impossible': False}),\n",
       " Prediction(uid=139015, iid=2694, r_ui=4.0, est=3.0206711658695498, details={'was_impossible': False}),\n",
       " Prediction(uid=84992, iid=296, r_ui=5.0, est=3.9046172153780203, details={'was_impossible': False}),\n",
       " Prediction(uid=69249, iid=48043, r_ui=4.0, est=3.7303952757451317, details={'was_impossible': False}),\n",
       " Prediction(uid=111414, iid=2908, r_ui=5.0, est=3.7341131517545687, details={'was_impossible': False}),\n",
       " Prediction(uid=161091, iid=100163, r_ui=4.0, est=3.3243155584981547, details={'was_impossible': False}),\n",
       " Prediction(uid=135896, iid=34332, r_ui=2.0, est=2.8831048120565717, details={'was_impossible': False}),\n",
       " Prediction(uid=29830, iid=5582, r_ui=4.0, est=3.766123156493965, details={'was_impossible': False}),\n",
       " Prediction(uid=157456, iid=4022, r_ui=3.0, est=3.78812368377534, details={'was_impossible': False}),\n",
       " Prediction(uid=113900, iid=88163, r_ui=4.0, est=3.2504561859894667, details={'was_impossible': False}),\n",
       " Prediction(uid=56751, iid=292, r_ui=4.5, est=3.3563607027005493, details={'was_impossible': False}),\n",
       " Prediction(uid=67651, iid=3696, r_ui=4.0, est=3.4590979470242575, details={'was_impossible': False}),\n",
       " Prediction(uid=5885, iid=3147, r_ui=3.5, est=3.7344852561689765, details={'was_impossible': False}),\n",
       " Prediction(uid=133569, iid=112852, r_ui=4.5, est=3.9063949583831246, details={'was_impossible': False}),\n",
       " Prediction(uid=115218, iid=2951, r_ui=3.0, est=4.111501386431342, details={'was_impossible': False}),\n",
       " Prediction(uid=21072, iid=308, r_ui=4.5, est=3.875936273815643, details={'was_impossible': False}),\n",
       " Prediction(uid=79145, iid=4890, r_ui=4.0, est=3.057831318481276, details={'was_impossible': False}),\n",
       " Prediction(uid=49796, iid=1196, r_ui=4.0, est=4.032249995925047, details={'was_impossible': False}),\n",
       " Prediction(uid=102270, iid=737, r_ui=1.5, est=3.155501493779887, details={'was_impossible': False}),\n",
       " Prediction(uid=40788, iid=1587, r_ui=2.0, est=3.5643533858884475, details={'was_impossible': False}),\n",
       " Prediction(uid=120481, iid=2329, r_ui=4.0, est=4.220166766645319, details={'was_impossible': False}),\n",
       " Prediction(uid=135974, iid=25835, r_ui=3.0, est=3.293021113390395, details={'was_impossible': False}),\n",
       " Prediction(uid=4052, iid=315, r_ui=3.0, est=3.1626870831353493, details={'was_impossible': False}),\n",
       " Prediction(uid=76334, iid=6537, r_ui=3.0, est=3.1645921660473015, details={'was_impossible': False}),\n",
       " Prediction(uid=3670, iid=92259, r_ui=5.0, est=4.130516846678022, details={'was_impossible': False}),\n",
       " Prediction(uid=131158, iid=81834, r_ui=3.0, est=3.777475478075471, details={'was_impossible': False}),\n",
       " Prediction(uid=160858, iid=7022, r_ui=4.0, est=3.708454193935575, details={'was_impossible': False}),\n",
       " Prediction(uid=3503, iid=46959, r_ui=3.0, est=3.0691427004715353, details={'was_impossible': False}),\n",
       " Prediction(uid=44784, iid=1201, r_ui=3.0, est=3.8991390290891377, details={'was_impossible': False}),\n",
       " Prediction(uid=71529, iid=612, r_ui=1.0, est=3.2243809566916477, details={'was_impossible': False}),\n",
       " Prediction(uid=20322, iid=410, r_ui=2.0, est=3.0238655991515975, details={'was_impossible': False}),\n",
       " Prediction(uid=45253, iid=6796, r_ui=4.5, est=3.5620075088622394, details={'was_impossible': False}),\n",
       " Prediction(uid=140538, iid=45447, r_ui=4.0, est=3.0846933058547905, details={'was_impossible': False}),\n",
       " Prediction(uid=17051, iid=37386, r_ui=2.5, est=3.556472465453358, details={'was_impossible': False}),\n",
       " Prediction(uid=41885, iid=6870, r_ui=4.0, est=3.6963937517769048, details={'was_impossible': False}),\n",
       " Prediction(uid=93885, iid=145030, r_ui=5.0, est=3.8915154098194624, details={'was_impossible': False}),\n",
       " Prediction(uid=97776, iid=70286, r_ui=3.5, est=3.4478501611369787, details={'was_impossible': False}),\n",
       " Prediction(uid=149884, iid=233, r_ui=3.0, est=3.5300802510699296, details={'was_impossible': False}),\n",
       " Prediction(uid=98638, iid=5012, r_ui=3.0, est=3.3158996190447634, details={'was_impossible': False}),\n",
       " Prediction(uid=30779, iid=590, r_ui=4.5, est=3.50311744947317, details={'was_impossible': False}),\n",
       " Prediction(uid=107661, iid=116977, r_ui=0.5, est=3.2485339656937695, details={'was_impossible': False}),\n",
       " Prediction(uid=159277, iid=150, r_ui=3.0, est=3.7052849135619157, details={'was_impossible': False}),\n",
       " Prediction(uid=136507, iid=7287, r_ui=3.5, est=3.3013828940329595, details={'was_impossible': False}),\n",
       " Prediction(uid=12223, iid=96634, r_ui=1.5, est=3.226844784068658, details={'was_impossible': False}),\n",
       " Prediction(uid=31516, iid=34162, r_ui=4.0, est=3.2172712688219396, details={'was_impossible': False}),\n",
       " Prediction(uid=148523, iid=1777, r_ui=3.5, est=3.256524419545799, details={'was_impossible': False}),\n",
       " Prediction(uid=95440, iid=2762, r_ui=5.0, est=3.931112999341586, details={'was_impossible': False}),\n",
       " Prediction(uid=80696, iid=1250, r_ui=5.0, est=3.9356954885308557, details={'was_impossible': False}),\n",
       " Prediction(uid=160640, iid=1220, r_ui=3.0, est=3.7282097599601762, details={'was_impossible': False}),\n",
       " Prediction(uid=107542, iid=4226, r_ui=4.0, est=4.044160591017009, details={'was_impossible': False}),\n",
       " Prediction(uid=162334, iid=8798, r_ui=4.0, est=3.7166797134319483, details={'was_impossible': False}),\n",
       " Prediction(uid=55941, iid=81591, r_ui=3.5, est=3.6028812170760194, details={'was_impossible': False}),\n",
       " Prediction(uid=55405, iid=6932, r_ui=3.5, est=3.5884515398731, details={'was_impossible': False}),\n",
       " Prediction(uid=57852, iid=1974, r_ui=4.0, est=3.1221374086279607, details={'was_impossible': False}),\n",
       " Prediction(uid=161556, iid=266, r_ui=1.0, est=3.205122829102728, details={'was_impossible': False}),\n",
       " Prediction(uid=123344, iid=34150, r_ui=4.5, est=2.6826890960813787, details={'was_impossible': False}),\n",
       " Prediction(uid=114613, iid=1293, r_ui=4.0, est=3.680533927916267, details={'was_impossible': False}),\n",
       " Prediction(uid=15821, iid=760, r_ui=4.0, est=3.789534901481023, details={'was_impossible': False}),\n",
       " Prediction(uid=548, iid=144306, r_ui=3.0, est=3.373654348359453, details={'was_impossible': False}),\n",
       " Prediction(uid=157333, iid=68749, r_ui=2.5, est=3.2129088117903417, details={'was_impossible': False}),\n",
       " Prediction(uid=148557, iid=3551, r_ui=5.0, est=3.8716472194777842, details={'was_impossible': False}),\n",
       " Prediction(uid=90557, iid=39, r_ui=4.0, est=3.317311563708015, details={'was_impossible': False}),\n",
       " Prediction(uid=94904, iid=1466, r_ui=4.0, est=3.7924527272767405, details={'was_impossible': False}),\n",
       " Prediction(uid=61325, iid=592, r_ui=5.0, est=3.5587359107403036, details={'was_impossible': False}),\n",
       " Prediction(uid=118647, iid=4703, r_ui=4.0, est=3.8036621195176568, details={'was_impossible': False}),\n",
       " Prediction(uid=127354, iid=54286, r_ui=4.0, est=3.9853200046194646, details={'was_impossible': False}),\n",
       " Prediction(uid=153754, iid=3044, r_ui=2.0, est=3.834880166533796, details={'was_impossible': False}),\n",
       " Prediction(uid=147285, iid=3481, r_ui=4.0, est=3.63542006994644, details={'was_impossible': False}),\n",
       " Prediction(uid=156380, iid=553, r_ui=4.5, est=3.5933772051574917, details={'was_impossible': False}),\n",
       " Prediction(uid=113105, iid=106841, r_ui=3.0, est=3.45871462553143, details={'was_impossible': False}),\n",
       " Prediction(uid=15476, iid=1487, r_ui=5.0, est=3.170866357720447, details={'was_impossible': False}),\n",
       " Prediction(uid=12284, iid=2959, r_ui=2.5, est=3.4988841772359316, details={'was_impossible': False}),\n",
       " Prediction(uid=18171, iid=4993, r_ui=3.0, est=3.864001402113336, details={'was_impossible': False}),\n",
       " Prediction(uid=152256, iid=260, r_ui=5.0, est=3.9221006291113225, details={'was_impossible': False}),\n",
       " Prediction(uid=2934, iid=2836, r_ui=3.0, est=3.403086857736143, details={'was_impossible': False}),\n",
       " Prediction(uid=150451, iid=122900, r_ui=4.0, est=3.6964180710984778, details={'was_impossible': False}),\n",
       " Prediction(uid=61379, iid=60609, r_ui=2.5, est=3.596359853989237, details={'was_impossible': False}),\n",
       " Prediction(uid=26651, iid=61240, r_ui=5.0, est=3.9382834345560784, details={'was_impossible': False}),\n",
       " Prediction(uid=148671, iid=497, r_ui=4.0, est=3.6499819599556145, details={'was_impossible': False}),\n",
       " Prediction(uid=130584, iid=34523, r_ui=2.5, est=3.6175793603322868, details={'was_impossible': False}),\n",
       " Prediction(uid=9894, iid=52042, r_ui=3.5, est=3.530950625987772, details={'was_impossible': False}),\n",
       " Prediction(uid=84300, iid=356, r_ui=4.0, est=3.8760644065296845, details={'was_impossible': False}),\n",
       " Prediction(uid=32204, iid=1086, r_ui=4.5, est=4.314520426295163, details={'was_impossible': False}),\n",
       " Prediction(uid=147700, iid=1663, r_ui=3.0, est=3.759060153629784, details={'was_impossible': False}),\n",
       " Prediction(uid=2878, iid=6025, r_ui=3.5, est=3.2523392711743355, details={'was_impossible': False}),\n",
       " Prediction(uid=133514, iid=1292, r_ui=4.0, est=4.0374112830086055, details={'was_impossible': False}),\n",
       " Prediction(uid=6752, iid=3956, r_ui=3.0, est=3.0080107566665073, details={'was_impossible': False}),\n",
       " Prediction(uid=42844, iid=140956, r_ui=3.5, est=3.3529065044558535, details={'was_impossible': False}),\n",
       " Prediction(uid=54768, iid=2770, r_ui=4.5, est=3.0088604353902126, details={'was_impossible': False}),\n",
       " Prediction(uid=124889, iid=475, r_ui=4.0, est=3.871534801225273, details={'was_impossible': False}),\n",
       " Prediction(uid=89527, iid=1968, r_ui=5.0, est=3.8534753984997776, details={'was_impossible': False}),\n",
       " Prediction(uid=3787, iid=4995, r_ui=4.5, est=3.773886865597454, details={'was_impossible': False}),\n",
       " Prediction(uid=18354, iid=6708, r_ui=3.5, est=3.79340503754866, details={'was_impossible': False}),\n",
       " Prediction(uid=128065, iid=117176, r_ui=3.0, est=3.7199134633429667, details={'was_impossible': False}),\n",
       " Prediction(uid=40748, iid=76251, r_ui=4.5, est=3.7174084212185337, details={'was_impossible': False}),\n",
       " Prediction(uid=31762, iid=2161, r_ui=3.5, est=3.1657191382168692, details={'was_impossible': False}),\n",
       " Prediction(uid=61214, iid=1196, r_ui=4.5, est=3.936201074909986, details={'was_impossible': False}),\n",
       " Prediction(uid=100711, iid=3554, r_ui=3.5, est=3.4159784869143395, details={'was_impossible': False}),\n",
       " Prediction(uid=42812, iid=224, r_ui=3.0, est=3.5093794759516372, details={'was_impossible': False}),\n",
       " Prediction(uid=34729, iid=85796, r_ui=3.5, est=3.535214285714286, details={'was_impossible': False}),\n",
       " Prediction(uid=86876, iid=59369, r_ui=4.5, est=3.9575188365739704, details={'was_impossible': False}),\n",
       " Prediction(uid=21493, iid=924, r_ui=2.5, est=3.670506052071442, details={'was_impossible': False}),\n",
       " Prediction(uid=13700, iid=2883, r_ui=4.0, est=3.4084448764581707, details={'was_impossible': False}),\n",
       " Prediction(uid=73670, iid=3125, r_ui=3.0, est=3.5170722650843946, details={'was_impossible': False}),\n",
       " Prediction(uid=152833, iid=38061, r_ui=5.0, est=3.632019520327381, details={'was_impossible': False}),\n",
       " Prediction(uid=111049, iid=1197, r_ui=3.0, est=3.935965921220554, details={'was_impossible': False}),\n",
       " Prediction(uid=34717, iid=6373, r_ui=4.0, est=3.3755084624385345, details={'was_impossible': False}),\n",
       " Prediction(uid=54806, iid=2502, r_ui=5.0, est=4.010077076780327, details={'was_impossible': False}),\n",
       " Prediction(uid=49896, iid=3114, r_ui=3.0, est=3.8332744240576755, details={'was_impossible': False}),\n",
       " Prediction(uid=153607, iid=329, r_ui=3.0, est=3.5981549452631056, details={'was_impossible': False}),\n",
       " Prediction(uid=93305, iid=33154, r_ui=4.0, est=3.913511313831496, details={'was_impossible': False}),\n",
       " Prediction(uid=118322, iid=1196, r_ui=5.0, est=4.032249995925047, details={'was_impossible': False}),\n",
       " Prediction(uid=52114, iid=832, r_ui=3.0, est=3.4702851905674055, details={'was_impossible': False}),\n",
       " Prediction(uid=1463, iid=149406, r_ui=4.0, est=3.8985527711125845, details={'was_impossible': False}),\n",
       " Prediction(uid=32859, iid=10, r_ui=5.0, est=3.3204127265512793, details={'was_impossible': False}),\n",
       " Prediction(uid=11138, iid=5690, r_ui=4.0, est=3.4267321796532895, details={'was_impossible': False}),\n",
       " Prediction(uid=124919, iid=58559, r_ui=4.5, est=3.629902456322538, details={'was_impossible': False}),\n",
       " Prediction(uid=24939, iid=1220, r_ui=3.0, est=3.7282097599601762, details={'was_impossible': False}),\n",
       " Prediction(uid=124621, iid=63062, r_ui=4.0, est=3.537136623566989, details={'was_impossible': False}),\n",
       " Prediction(uid=11417, iid=5995, r_ui=0.5, est=3.2274941187815043, details={'was_impossible': False}),\n",
       " Prediction(uid=68002, iid=3770, r_ui=5.0, est=3.8406676139384044, details={'was_impossible': False}),\n",
       " Prediction(uid=68899, iid=246, r_ui=2.0, est=3.7822360195819047, details={'was_impossible': False}),\n",
       " Prediction(uid=32319, iid=49530, r_ui=2.5, est=3.742802795374538, details={'was_impossible': False}),\n",
       " Prediction(uid=36131, iid=356, r_ui=4.0, est=3.8748653707619605, details={'was_impossible': False}),\n",
       " Prediction(uid=29021, iid=8798, r_ui=2.5, est=3.7808703824351633, details={'was_impossible': False}),\n",
       " Prediction(uid=127129, iid=3578, r_ui=4.0, est=3.8190343205662014, details={'was_impossible': False}),\n",
       " Prediction(uid=86843, iid=5103, r_ui=3.0, est=3.5951936864735723, details={'was_impossible': False}),\n",
       " Prediction(uid=141040, iid=4016, r_ui=5.0, est=3.851839061921018, details={'was_impossible': False}),\n",
       " Prediction(uid=39259, iid=27904, r_ui=3.0, est=3.5252552853180634, details={'was_impossible': False}),\n",
       " Prediction(uid=20276, iid=8874, r_ui=4.0, est=3.8058731035954305, details={'was_impossible': False}),\n",
       " Prediction(uid=21673, iid=60040, r_ui=2.5, est=3.1926320696959283, details={'was_impossible': False}),\n",
       " Prediction(uid=69222, iid=99114, r_ui=2.0, est=3.8687243439121906, details={'was_impossible': False}),\n",
       " Prediction(uid=10162, iid=1762, r_ui=4.5, est=3.304751650258485, details={'was_impossible': False}),\n",
       " Prediction(uid=118445, iid=539, r_ui=2.0, est=3.372171913960741, details={'was_impossible': False}),\n",
       " Prediction(uid=37448, iid=58998, r_ui=2.0, est=3.033811892591683, details={'was_impossible': False}),\n",
       " Prediction(uid=85556, iid=1036, r_ui=4.0, est=3.9974323566474186, details={'was_impossible': False}),\n",
       " Prediction(uid=142150, iid=4226, r_ui=3.0, est=4.044160591017009, details={'was_impossible': False}),\n",
       " Prediction(uid=70558, iid=3755, r_ui=3.0, est=3.686990639683197, details={'was_impossible': False}),\n",
       " Prediction(uid=574, iid=1213, r_ui=3.0, est=4.2161618324279235, details={'was_impossible': False}),\n",
       " Prediction(uid=59910, iid=494, r_ui=4.0, est=3.3144060965482836, details={'was_impossible': False}),\n",
       " Prediction(uid=77062, iid=45722, r_ui=2.5, est=3.268911203867708, details={'was_impossible': False}),\n",
       " Prediction(uid=31599, iid=2029, r_ui=2.0, est=3.458394761542152, details={'was_impossible': False}),\n",
       " Prediction(uid=28369, iid=98809, r_ui=3.5, est=3.7855444684037285, details={'was_impossible': False}),\n",
       " Prediction(uid=42496, iid=84615, r_ui=3.0, est=2.820203677822213, details={'was_impossible': False}),\n",
       " Prediction(uid=43581, iid=457, r_ui=5.0, est=3.9162693304349094, details={'was_impossible': False}),\n",
       " Prediction(uid=118964, iid=923, r_ui=3.5, est=3.6147574132752354, details={'was_impossible': False}),\n",
       " Prediction(uid=30719, iid=86833, r_ui=4.0, est=3.568611894881728, details={'was_impossible': False}),\n",
       " Prediction(uid=150139, iid=86377, r_ui=3.0, est=3.595661471521748, details={'was_impossible': False}),\n",
       " Prediction(uid=109166, iid=500, r_ui=4.0, est=3.5373520574148785, details={'was_impossible': False}),\n",
       " Prediction(uid=32019, iid=55721, r_ui=5.0, est=3.8655537100056456, details={'was_impossible': False}),\n",
       " Prediction(uid=63653, iid=5201, r_ui=2.5, est=3.325350694024157, details={'was_impossible': False}),\n",
       " Prediction(uid=160014, iid=1466, r_ui=4.0, est=3.703748618159376, details={'was_impossible': False}),\n",
       " Prediction(uid=91338, iid=3421, r_ui=3.5, est=3.3867801944455063, details={'was_impossible': False}),\n",
       " Prediction(uid=153952, iid=64575, r_ui=4.5, est=3.7313617894890467, details={'was_impossible': False}),\n",
       " Prediction(uid=93475, iid=6710, r_ui=3.0, est=3.2647679000869068, details={'was_impossible': False}),\n",
       " Prediction(uid=27053, iid=377, r_ui=4.5, est=3.4682314897317834, details={'was_impossible': False}),\n",
       " Prediction(uid=75287, iid=4226, r_ui=4.5, est=4.039931564920528, details={'was_impossible': False}),\n",
       " Prediction(uid=121025, iid=608, r_ui=4.0, est=4.056293587461959, details={'was_impossible': False}),\n",
       " Prediction(uid=107534, iid=5349, r_ui=3.5, est=3.4193046001802707, details={'was_impossible': False}),\n",
       " Prediction(uid=149163, iid=4367, r_ui=2.0, est=2.608608459534307, details={'was_impossible': False}),\n",
       " Prediction(uid=80948, iid=7835, r_ui=3.5, est=2.2219885591722566, details={'was_impossible': False}),\n",
       " Prediction(uid=128894, iid=2528, r_ui=4.0, est=3.336840801189384, details={'was_impossible': False}),\n",
       " Prediction(uid=112718, iid=4246, r_ui=2.0, est=3.7055834507103493, details={'was_impossible': False}),\n",
       " Prediction(uid=20471, iid=736, r_ui=3.5, est=3.438061208437113, details={'was_impossible': False}),\n",
       " Prediction(uid=494, iid=4369, r_ui=3.5, est=2.8431898344649325, details={'was_impossible': False}),\n",
       " Prediction(uid=26104, iid=8327, r_ui=4.0, est=3.5153255920145794, details={'was_impossible': False}),\n",
       " Prediction(uid=86762, iid=5738, r_ui=3.5, est=3.535214285714286, details={'was_impossible': False}),\n",
       " Prediction(uid=83780, iid=34072, r_ui=3.5, est=3.2997106834834926, details={'was_impossible': False}),\n",
       " Prediction(uid=49659, iid=778, r_ui=5.0, est=3.9035308352376497, details={'was_impossible': False}),\n",
       " Prediction(uid=113251, iid=2125, r_ui=3.0, est=3.6029742809524814, details={'was_impossible': False}),\n",
       " Prediction(uid=118389, iid=4246, r_ui=3.0, est=3.7055834507103493, details={'was_impossible': False}),\n",
       " Prediction(uid=144661, iid=1127, r_ui=3.0, est=3.3958195690380424, details={'was_impossible': False}),\n",
       " Prediction(uid=162309, iid=5879, r_ui=2.5, est=2.7330527574445087, details={'was_impossible': False}),\n",
       " Prediction(uid=74359, iid=133867, r_ui=4.0, est=3.7669794882266032, details={'was_impossible': False}),\n",
       " Prediction(uid=82818, iid=2080, r_ui=4.0, est=3.673050618252508, details={'was_impossible': False}),\n",
       " Prediction(uid=47370, iid=952, r_ui=4.0, est=3.795493757564234, details={'was_impossible': False}),\n",
       " Prediction(uid=81413, iid=520, r_ui=3.0, est=2.9103682693357404, details={'was_impossible': False}),\n",
       " Prediction(uid=99829, iid=41569, r_ui=3.0, est=3.1132538793693136, details={'was_impossible': False}),\n",
       " Prediction(uid=82571, iid=2115, r_ui=5.0, est=3.741316598723661, details={'was_impossible': False}),\n",
       " Prediction(uid=154746, iid=54272, r_ui=4.0, est=3.6398635607094403, details={'was_impossible': False}),\n",
       " Prediction(uid=120687, iid=2710, r_ui=1.0, est=3.1036736852143965, details={'was_impossible': False}),\n",
       " Prediction(uid=115177, iid=6201, r_ui=4.0, est=3.1896419723862213, details={'was_impossible': False}),\n",
       " Prediction(uid=123332, iid=7569, r_ui=3.0, est=3.437117667060724, details={'was_impossible': False}),\n",
       " Prediction(uid=58088, iid=1407, r_ui=4.0, est=3.4338081359488886, details={'was_impossible': False}),\n",
       " Prediction(uid=9413, iid=155828, r_ui=2.0, est=3.535214285714286, details={'was_impossible': False}),\n",
       " Prediction(uid=126583, iid=349, r_ui=3.5, est=3.633424911381845, details={'was_impossible': False}),\n",
       " Prediction(uid=2517, iid=160, r_ui=1.0, est=3.016830598722788, details={'was_impossible': False}),\n",
       " Prediction(uid=158794, iid=110501, r_ui=4.0, est=3.746429471505079, details={'was_impossible': False}),\n",
       " Prediction(uid=848, iid=90738, r_ui=3.5, est=3.2666852434654574, details={'was_impossible': False}),\n",
       " Prediction(uid=14336, iid=1920, r_ui=3.0, est=2.8358176859890074, details={'was_impossible': False}),\n",
       " Prediction(uid=3698, iid=53125, r_ui=3.5, est=3.5140808459488535, details={'was_impossible': False}),\n",
       " Prediction(uid=137887, iid=508, r_ui=4.0, est=3.766731733933751, details={'was_impossible': False}),\n",
       " Prediction(uid=30809, iid=208, r_ui=3.0, est=2.8372463350240515, details={'was_impossible': False}),\n",
       " Prediction(uid=128192, iid=22, r_ui=4.0, est=3.2575253989711506, details={'was_impossible': False}),\n",
       " Prediction(uid=148274, iid=5103, r_ui=2.5, est=2.9156228848933567, details={'was_impossible': False}),\n",
       " Prediction(uid=90079, iid=1707, r_ui=1.5, est=2.2020658621134994, details={'was_impossible': False}),\n",
       " Prediction(uid=109389, iid=76860, r_ui=3.0, est=3.535214285714286, details={'was_impossible': False}),\n",
       " Prediction(uid=151980, iid=3083, r_ui=4.0, est=3.5532027668034423, details={'was_impossible': False}),\n",
       " Prediction(uid=139539, iid=349, r_ui=3.0, est=3.580347351941792, details={'was_impossible': False}),\n",
       " Prediction(uid=74860, iid=5990, r_ui=3.0, est=3.535214285714286, details={'was_impossible': False}),\n",
       " Prediction(uid=47560, iid=2098, r_ui=4.0, est=3.523072207261206, details={'was_impossible': False}),\n",
       " Prediction(uid=91908, iid=5991, r_ui=4.0, est=3.5959647390754834, details={'was_impossible': False}),\n",
       " Prediction(uid=123489, iid=2376, r_ui=3.0, est=3.7281183784945444, details={'was_impossible': False}),\n",
       " Prediction(uid=63951, iid=339, r_ui=3.0, est=3.45469490768098, details={'was_impossible': False}),\n",
       " Prediction(uid=103258, iid=110771, r_ui=3.0, est=3.3609719935088638, details={'was_impossible': False}),\n",
       " Prediction(uid=70773, iid=589, r_ui=3.0, est=3.942223404735326, details={'was_impossible': False}),\n",
       " Prediction(uid=116940, iid=1967, r_ui=3.5, est=3.7516081488364437, details={'was_impossible': False}),\n",
       " Prediction(uid=28990, iid=2716, r_ui=5.0, est=4.207296180901805, details={'was_impossible': False}),\n",
       " Prediction(uid=30920, iid=531, r_ui=3.0, est=3.553973270522763, details={'was_impossible': False}),\n",
       " Prediction(uid=137726, iid=8984, r_ui=3.0, est=3.325087805834772, details={'was_impossible': False}),\n",
       " Prediction(uid=13410, iid=8807, r_ui=3.5, est=3.1735367135937125, details={'was_impossible': False}),\n",
       " Prediction(uid=93756, iid=4361, r_ui=4.5, est=3.593805014845201, details={'was_impossible': False}),\n",
       " Prediction(uid=115970, iid=92259, r_ui=4.0, est=4.130516846678022, details={'was_impossible': False}),\n",
       " Prediction(uid=148878, iid=64575, r_ui=4.0, est=3.7313617894890467, details={'was_impossible': False}),\n",
       " Prediction(uid=44766, iid=2174, r_ui=0.5, est=3.4096570150355854, details={'was_impossible': False}),\n",
       " Prediction(uid=116404, iid=64249, r_ui=2.0, est=3.763074882390451, details={'was_impossible': False}),\n",
       " Prediction(uid=6880, iid=6539, r_ui=4.0, est=3.8076946075159728, details={'was_impossible': False}),\n",
       " Prediction(uid=57765, iid=4979, r_ui=5.0, est=3.513995486611816, details={'was_impossible': False}),\n",
       " Prediction(uid=143619, iid=81180, r_ui=4.5, est=3.64697944434224, details={'was_impossible': False}),\n",
       " Prediction(uid=79828, iid=85414, r_ui=4.5, est=3.5276802450162585, details={'was_impossible': False}),\n",
       " Prediction(uid=97096, iid=6800, r_ui=4.0, est=2.7027253723283615, details={'was_impossible': False}),\n",
       " Prediction(uid=81694, iid=102716, r_ui=3.0, est=3.705608191305325, details={'was_impossible': False}),\n",
       " Prediction(uid=15501, iid=1594, r_ui=4.0, est=3.387016130445692, details={'was_impossible': False}),\n",
       " Prediction(uid=154663, iid=1569, r_ui=3.0, est=3.745516035243776, details={'was_impossible': False}),\n",
       " Prediction(uid=123602, iid=11, r_ui=3.0, est=3.5701785182319723, details={'was_impossible': False}),\n",
       " Prediction(uid=36213, iid=2761, r_ui=4.0, est=4.038992254114828, details={'was_impossible': False}),\n",
       " Prediction(uid=37501, iid=1258, r_ui=5.0, est=3.933701841034611, details={'was_impossible': False}),\n",
       " Prediction(uid=105939, iid=249, r_ui=3.5, est=3.803578153611992, details={'was_impossible': False}),\n",
       " Prediction(uid=149148, iid=999, r_ui=5.0, est=3.5566383445211227, details={'was_impossible': False}),\n",
       " Prediction(uid=133397, iid=1210, r_ui=5.0, est=4.034895906269918, details={'was_impossible': False}),\n",
       " Prediction(uid=124495, iid=587, r_ui=5.0, est=3.4472306271758337, details={'was_impossible': False}),\n",
       " Prediction(uid=100851, iid=4993, r_ui=5.0, est=3.613447297619597, details={'was_impossible': False}),\n",
       " Prediction(uid=117563, iid=120474, r_ui=4.0, est=3.535214285714286, details={'was_impossible': False}),\n",
       " Prediction(uid=131506, iid=6888, r_ui=3.5, est=3.1660019627155074, details={'was_impossible': False}),\n",
       " Prediction(uid=21046, iid=108727, r_ui=3.5, est=3.5612233026557627, details={'was_impossible': False}),\n",
       " Prediction(uid=88536, iid=265, r_ui=3.0, est=3.7219072683971612, details={'was_impossible': False}),\n",
       " Prediction(uid=156518, iid=5952, r_ui=4.5, est=4.029069345941733, details={'was_impossible': False}),\n",
       " Prediction(uid=143729, iid=4628, r_ui=4.0, est=3.6536699929095984, details={'was_impossible': False}),\n",
       " Prediction(uid=148678, iid=153, r_ui=5.0, est=3.032047406750298, details={'was_impossible': False}),\n",
       " Prediction(uid=62344, iid=127116, r_ui=4.0, est=3.6123964379732656, details={'was_impossible': False}),\n",
       " Prediction(uid=69592, iid=93840, r_ui=3.5, est=3.634564860483514, details={'was_impossible': False}),\n",
       " Prediction(uid=33006, iid=1198, r_ui=4.5, est=4.061504830179716, details={'was_impossible': False}),\n",
       " Prediction(uid=20585, iid=1885, r_ui=3.0, est=2.523206002807425, details={'was_impossible': False}),\n",
       " Prediction(uid=147413, iid=2735, r_ui=2.0, est=3.1284782787612873, details={'was_impossible': False}),\n",
       " Prediction(uid=150145, iid=111921, r_ui=4.5, est=3.260676157673953, details={'was_impossible': False}),\n",
       " Prediction(uid=27270, iid=916, r_ui=4.0, est=3.8839501983102105, details={'was_impossible': False}),\n",
       " Prediction(uid=135526, iid=1093, r_ui=4.0, est=3.167500001111217, details={'was_impossible': False}),\n",
       " Prediction(uid=87037, iid=420, r_ui=4.0, est=2.8231555790457747, details={'was_impossible': False}),\n",
       " Prediction(uid=82199, iid=96861, r_ui=3.5, est=3.2263126427199906, details={'was_impossible': False}),\n",
       " Prediction(uid=3747, iid=135532, r_ui=2.5, est=3.50769615308387, details={'was_impossible': False}),\n",
       " Prediction(uid=7519, iid=454, r_ui=4.0, est=3.623261284004788, details={'was_impossible': False}),\n",
       " Prediction(uid=83488, iid=3977, r_ui=3.0, est=3.0038478896811136, details={'was_impossible': False}),\n",
       " Prediction(uid=121509, iid=2471, r_ui=3.0, est=2.5595378889991687, details={'was_impossible': False}),\n",
       " Prediction(uid=26026, iid=30812, r_ui=3.5, est=3.70343448318495, details={'was_impossible': False}),\n",
       " Prediction(uid=6295, iid=1641, r_ui=4.0, est=3.342834466197549, details={'was_impossible': False}),\n",
       " Prediction(uid=149105, iid=1092, r_ui=5.0, est=3.5975779140091446, details={'was_impossible': False}),\n",
       " Prediction(uid=108312, iid=541, r_ui=4.0, est=3.9452044684719647, details={'was_impossible': False}),\n",
       " Prediction(uid=109673, iid=1729, r_ui=4.0, est=3.7824852690130477, details={'was_impossible': False}),\n",
       " Prediction(uid=4820, iid=33166, r_ui=5.0, est=3.8420332832877535, details={'was_impossible': False}),\n",
       " Prediction(uid=106434, iid=165, r_ui=4.0, est=3.5736214433188533, details={'was_impossible': False}),\n",
       " Prediction(uid=120585, iid=1961, r_ui=4.0, est=3.7631907046201443, details={'was_impossible': False}),\n",
       " Prediction(uid=133209, iid=2115, r_ui=2.0, est=3.296620296547945, details={'was_impossible': False}),\n",
       " Prediction(uid=120385, iid=3623, r_ui=2.5, est=2.6480780976342237, details={'was_impossible': False}),\n",
       " Prediction(uid=51630, iid=119145, r_ui=4.0, est=3.7032262362657455, details={'was_impossible': False}),\n",
       " Prediction(uid=15416, iid=2567, r_ui=4.0, est=3.2156006458547006, details={'was_impossible': False}),\n",
       " Prediction(uid=140382, iid=2976, r_ui=3.0, est=3.5136368726981124, details={'was_impossible': False}),\n",
       " Prediction(uid=137132, iid=904, r_ui=4.0, est=3.979018882621102, details={'was_impossible': False}),\n",
       " Prediction(uid=77892, iid=44022, r_ui=3.5, est=3.175724161542231, details={'was_impossible': False}),\n",
       " Prediction(uid=51116, iid=5400, r_ui=4.0, est=3.373016486068727, details={'was_impossible': False}),\n",
       " Prediction(uid=15349, iid=1882, r_ui=2.0, est=2.575171835304379, details={'was_impossible': False}),\n",
       " Prediction(uid=26842, iid=164280, r_ui=4.5, est=3.562117750363276, details={'was_impossible': False}),\n",
       " Prediction(uid=38329, iid=1234, r_ui=5.0, est=3.783765823862072, details={'was_impossible': False}),\n",
       " Prediction(uid=56581, iid=318, r_ui=5.0, est=4.28323419495754, details={'was_impossible': False}),\n",
       " Prediction(uid=39413, iid=318, r_ui=4.5, est=4.28323419495754, details={'was_impossible': False}),\n",
       " Prediction(uid=131808, iid=55765, r_ui=4.0, est=3.7165927481072396, details={'was_impossible': False}),\n",
       " Prediction(uid=33700, iid=1, r_ui=3.5, est=3.688084448109359, details={'was_impossible': False}),\n",
       " Prediction(uid=70336, iid=2351, r_ui=5.0, est=3.4056007100811136, details={'was_impossible': False}),\n",
       " Prediction(uid=15220, iid=6380, r_ui=4.0, est=3.7449507105491158, details={'was_impossible': False}),\n",
       " Prediction(uid=62412, iid=39, r_ui=3.0, est=3.4055839071011347, details={'was_impossible': False}),\n",
       " Prediction(uid=65159, iid=106696, r_ui=3.0, est=3.164236474599972, details={'was_impossible': False}),\n",
       " Prediction(uid=41131, iid=7026, r_ui=3.0, est=3.3499353894705908, details={'was_impossible': False}),\n",
       " Prediction(uid=120443, iid=2003, r_ui=4.0, est=3.4392460097937048, details={'was_impossible': False}),\n",
       " Prediction(uid=139389, iid=7458, r_ui=5.0, est=3.6748511968767756, details={'was_impossible': False}),\n",
       " Prediction(uid=47370, iid=1517, r_ui=3.5, est=3.5286776707239453, details={'was_impossible': False}),\n",
       " Prediction(uid=140698, iid=593, r_ui=5.0, est=3.977554465146632, details={'was_impossible': False}),\n",
       " Prediction(uid=108837, iid=2151, r_ui=3.0, est=3.894699404754722, details={'was_impossible': False}),\n",
       " Prediction(uid=38150, iid=117533, r_ui=4.5, est=3.7619381662757863, details={'was_impossible': False}),\n",
       " Prediction(uid=18306, iid=4149, r_ui=1.5, est=3.0311400702942333, details={'was_impossible': False}),\n",
       " Prediction(uid=123447, iid=2987, r_ui=3.0, est=3.5753972880518967, details={'was_impossible': False}),\n",
       " Prediction(uid=54838, iid=2021, r_ui=3.5, est=3.435490920807571, details={'was_impossible': False}),\n",
       " Prediction(uid=121380, iid=87529, r_ui=4.5, est=3.866585023067834, details={'was_impossible': False}),\n",
       " Prediction(uid=6966, iid=16, r_ui=5.0, est=3.8227597242571307, details={'was_impossible': False}),\n",
       " Prediction(uid=83699, iid=2394, r_ui=4.5, est=3.7538379585679835, details={'was_impossible': False}),\n",
       " Prediction(uid=127385, iid=3440, r_ui=1.0, est=3.148926177137845, details={'was_impossible': False}),\n",
       " Prediction(uid=105034, iid=590, r_ui=2.0, est=3.623654453823017, details={'was_impossible': False}),\n",
       " Prediction(uid=151929, iid=7173, r_ui=3.0, est=2.8698673657868614, details={'was_impossible': False}),\n",
       " Prediction(uid=23600, iid=533, r_ui=1.0, est=3.060846822067191, details={'was_impossible': False}),\n",
       " Prediction(uid=29531, iid=1250, r_ui=4.0, est=3.9356954885308557, details={'was_impossible': False}),\n",
       " Prediction(uid=159816, iid=3067, r_ui=4.0, est=4.123075295034515, details={'was_impossible': False}),\n",
       " Prediction(uid=48471, iid=152081, r_ui=3.5, est=3.748743736269913, details={'was_impossible': False}),\n",
       " Prediction(uid=20737, iid=5952, r_ui=5.0, est=3.9876585506959783, details={'was_impossible': False}),\n",
       " Prediction(uid=45027, iid=1288, r_ui=4.5, est=3.6535137166161733, details={'was_impossible': False}),\n",
       " Prediction(uid=60148, iid=2997, r_ui=4.5, est=4.096027694893929, details={'was_impossible': False}),\n",
       " Prediction(uid=74079, iid=69640, r_ui=3.5, est=3.6599550656914794, details={'was_impossible': False}),\n",
       " Prediction(uid=9116, iid=157699, r_ui=3.0, est=3.59288520680083, details={'was_impossible': False}),\n",
       " Prediction(uid=155376, iid=2054, r_ui=4.0, est=2.545822221357909, details={'was_impossible': False}),\n",
       " Prediction(uid=99788, iid=5047, r_ui=4.5, est=3.1399711061982885, details={'was_impossible': False}),\n",
       " Prediction(uid=162442, iid=185, r_ui=0.5, est=3.082697719224637, details={'was_impossible': False}),\n",
       " Prediction(uid=103169, iid=113250, r_ui=4.0, est=3.5861713300784146, details={'was_impossible': False}),\n",
       " Prediction(uid=3169, iid=292, r_ui=3.0, est=3.3563607027005493, details={'was_impossible': False}),\n",
       " Prediction(uid=50739, iid=2735, r_ui=4.0, est=3.432373771272191, details={'was_impossible': False}),\n",
       " Prediction(uid=9701, iid=1246, r_ui=4.0, est=3.9276865977607223, details={'was_impossible': False}),\n",
       " Prediction(uid=145213, iid=1573, r_ui=4.0, est=3.4130932760314954, details={'was_impossible': False}),\n",
       " Prediction(uid=152875, iid=778, r_ui=4.0, est=3.7437912515416514, details={'was_impossible': False}),\n",
       " Prediction(uid=128779, iid=78099, r_ui=3.5, est=3.489043046712543, details={'was_impossible': False}),\n",
       " Prediction(uid=48338, iid=3741, r_ui=4.0, est=3.4504469731735568, details={'was_impossible': False}),\n",
       " Prediction(uid=53874, iid=1836, r_ui=5.0, est=3.2352275119676137, details={'was_impossible': False}),\n",
       " Prediction(uid=112122, iid=5989, r_ui=4.0, est=3.7031548578883786, details={'was_impossible': False}),\n",
       " Prediction(uid=53257, iid=318, r_ui=5.0, est=4.28323419495754, details={'was_impossible': False}),\n",
       " Prediction(uid=104607, iid=7323, r_ui=4.5, est=3.729545093165005, details={'was_impossible': False}),\n",
       " Prediction(uid=67279, iid=112175, r_ui=4.0, est=3.678291182294715, details={'was_impossible': False}),\n",
       " Prediction(uid=154793, iid=5267, r_ui=5.0, est=3.431320668182799, details={'was_impossible': False}),\n",
       " Prediction(uid=84648, iid=50, r_ui=5.0, est=4.172686906071082, details={'was_impossible': False}),\n",
       " Prediction(uid=151938, iid=154, r_ui=2.5, est=3.3763415843064286, details={'was_impossible': False}),\n",
       " Prediction(uid=146744, iid=70, r_ui=1.0, est=3.4817585041840453, details={'was_impossible': False}),\n",
       " Prediction(uid=153614, iid=4019, r_ui=4.0, est=3.472253000473041, details={'was_impossible': False}),\n",
       " Prediction(uid=86462, iid=6880, r_ui=3.5, est=3.135592378599699, details={'was_impossible': False}),\n",
       " Prediction(uid=70176, iid=122904, r_ui=4.0, est=3.843617158138317, details={'was_impossible': False}),\n",
       " Prediction(uid=105108, iid=2724, r_ui=3.0, est=2.8774404195374204, details={'was_impossible': False}),\n",
       " Prediction(uid=27263, iid=6238, r_ui=3.0, est=3.4868744426690466, details={'was_impossible': False}),\n",
       " Prediction(uid=6807, iid=5944, r_ui=2.5, est=2.835187827611285, details={'was_impossible': False}),\n",
       " Prediction(uid=78843, iid=2819, r_ui=3.5, est=3.659703360269799, details={'was_impossible': False}),\n",
       " Prediction(uid=17507, iid=3156, r_ui=4.0, est=3.4552296932541973, details={'was_impossible': False}),\n",
       " Prediction(uid=64173, iid=3424, r_ui=3.0, est=3.6900396619316975, details={'was_impossible': False}),\n",
       " Prediction(uid=67329, iid=150, r_ui=3.0, est=3.7052849135619157, details={'was_impossible': False}),\n",
       " Prediction(uid=157052, iid=333, r_ui=4.0, est=3.568693701597893, details={'was_impossible': False}),\n",
       " Prediction(uid=805, iid=2134, r_ui=4.0, est=3.2080775298122974, details={'was_impossible': False}),\n",
       " Prediction(uid=144441, iid=103249, r_ui=4.0, est=3.345515035016624, details={'was_impossible': False}),\n",
       " Prediction(uid=154161, iid=1196, r_ui=5.0, est=4.032249995925047, details={'was_impossible': False}),\n",
       " Prediction(uid=94781, iid=7, r_ui=3.0, est=3.411400773327882, details={'was_impossible': False}),\n",
       " Prediction(uid=39292, iid=112087, r_ui=4.5, est=3.6447204046890334, details={'was_impossible': False}),\n",
       " Prediction(uid=42336, iid=3113, r_ui=4.0, est=3.1797609772423634, details={'was_impossible': False}),\n",
       " Prediction(uid=84322, iid=2028, r_ui=4.0, est=4.217064066409299, details={'was_impossible': False}),\n",
       " Prediction(uid=81680, iid=316, r_ui=3.5, est=3.5611489284155486, details={'was_impossible': False}),\n",
       " Prediction(uid=100587, iid=788, r_ui=1.0, est=2.6838783396613315, details={'was_impossible': False}),\n",
       " Prediction(uid=78849, iid=52299, r_ui=2.5, est=3.2610051186622973, details={'was_impossible': False}),\n",
       " Prediction(uid=6677, iid=196, r_ui=1.0, est=2.7165561270128675, details={'was_impossible': False}),\n",
       " Prediction(uid=120514, iid=380, r_ui=3.0, est=3.4531555546109356, details={'was_impossible': False}),\n",
       " Prediction(uid=123359, iid=4018, r_ui=1.5, est=3.0758780976968207, details={'was_impossible': False}),\n",
       " Prediction(uid=124327, iid=1610, r_ui=4.0, est=3.863571999097615, details={'was_impossible': False}),\n",
       " Prediction(uid=13438, iid=1088, r_ui=4.5, est=3.740516670095459, details={'was_impossible': False}),\n",
       " Prediction(uid=23306, iid=29, r_ui=4.0, est=4.017994797862573, details={'was_impossible': False}),\n",
       " Prediction(uid=41011, iid=5679, r_ui=3.0, est=3.225484328438092, details={'was_impossible': False}),\n",
       " Prediction(uid=9628, iid=27716, r_ui=4.0, est=3.5592209421707337, details={'was_impossible': False}),\n",
       " Prediction(uid=49873, iid=4027, r_ui=2.5, est=3.694436876152893, details={'was_impossible': False}),\n",
       " Prediction(uid=84922, iid=2881, r_ui=4.0, est=3.424412691761241, details={'was_impossible': False}),\n",
       " Prediction(uid=125210, iid=1953, r_ui=4.0, est=3.593132151449231, details={'was_impossible': False}),\n",
       " Prediction(uid=102006, iid=3548, r_ui=3.0, est=3.970444040520408, details={'was_impossible': False}),\n",
       " Prediction(uid=55105, iid=3146, r_ui=1.0, est=2.4914559983028144, details={'was_impossible': False}),\n",
       " Prediction(uid=149745, iid=1962, r_ui=1.0, est=3.470842104693453, details={'was_impossible': False}),\n",
       " Prediction(uid=5018, iid=164179, r_ui=5.0, est=3.6457200293388303, details={'was_impossible': False}),\n",
       " Prediction(uid=86863, iid=531, r_ui=2.0, est=3.152338750768417, details={'was_impossible': False}),\n",
       " Prediction(uid=27896, iid=53125, r_ui=3.5, est=3.59015920710971, details={'was_impossible': False}),\n",
       " Prediction(uid=27700, iid=3686, r_ui=3.0, est=3.352863952372696, details={'was_impossible': False}),\n",
       " Prediction(uid=71628, iid=63082, r_ui=3.5, est=3.718814230026804, details={'was_impossible': False}),\n",
       " Prediction(uid=12979, iid=50068, r_ui=3.5, est=3.6389933702393695, details={'was_impossible': False}),\n",
       " Prediction(uid=123207, iid=46335, r_ui=3.0, est=3.0040261626626017, details={'was_impossible': False}),\n",
       " Prediction(uid=148400, iid=6, r_ui=5.0, est=3.7854650635918667, details={'was_impossible': False}),\n",
       " Prediction(uid=119674, iid=1732, r_ui=5.0, est=3.9623689453238815, details={'was_impossible': False}),\n",
       " Prediction(uid=122499, iid=1244, r_ui=5.0, est=3.7906785027093264, details={'was_impossible': False}),\n",
       " Prediction(uid=1219, iid=1358, r_ui=4.5, est=3.928081949721927, details={'was_impossible': False}),\n",
       " Prediction(uid=67809, iid=1704, r_ui=4.5, est=4.055996907895736, details={'was_impossible': False}),\n",
       " Prediction(uid=88101, iid=360, r_ui=3.0, est=2.980166196412113, details={'was_impossible': False}),\n",
       " Prediction(uid=116195, iid=4378, r_ui=4.0, est=3.5373469877142965, details={'was_impossible': False}),\n",
       " Prediction(uid=145989, iid=1136, r_ui=3.0, est=3.713291173024844, details={'was_impossible': False}),\n",
       " Prediction(uid=1711, iid=32296, r_ui=4.5, est=3.1704473978238226, details={'was_impossible': False}),\n",
       " Prediction(uid=14475, iid=48774, r_ui=3.0, est=3.9983404824170243, details={'was_impossible': False}),\n",
       " Prediction(uid=98838, iid=527, r_ui=4.0, est=4.040323950259012, details={'was_impossible': False}),\n",
       " Prediction(uid=127311, iid=71579, r_ui=4.0, est=3.794194913500086, details={'was_impossible': False}),\n",
       " Prediction(uid=123509, iid=3204, r_ui=4.0, est=3.355784889334316, details={'was_impossible': False}),\n",
       " Prediction(uid=123072, iid=1918, r_ui=3.0, est=3.044152729595329, details={'was_impossible': False}),\n",
       " Prediction(uid=161508, iid=3993, r_ui=5.0, est=3.714606873285924, details={'was_impossible': False}),\n",
       " Prediction(uid=80265, iid=2115, r_ui=3.0, est=3.7811637971562457, details={'was_impossible': False}),\n",
       " Prediction(uid=159126, iid=780, r_ui=4.0, est=3.6185535536742375, details={'was_impossible': False}),\n",
       " Prediction(uid=2058, iid=1011, r_ui=2.5, est=3.3024556325789973, details={'was_impossible': False}),\n",
       " Prediction(uid=157302, iid=253, r_ui=4.0, est=3.6156353620769566, details={'was_impossible': False}),\n",
       " Prediction(uid=63893, iid=1682, r_ui=4.0, est=3.8290437797841212, details={'was_impossible': False}),\n",
       " Prediction(uid=63491, iid=89774, r_ui=4.0, est=3.6316520427996424, details={'was_impossible': False}),\n",
       " Prediction(uid=100718, iid=6377, r_ui=4.0, est=3.899210927468696, details={'was_impossible': False}),\n",
       " Prediction(uid=102834, iid=2034, r_ui=2.0, est=3.260304004800047, details={'was_impossible': False}),\n",
       " Prediction(uid=9370, iid=2571, r_ui=5.0, est=3.969686656240947, details={'was_impossible': False}),\n",
       " Prediction(uid=147394, iid=2297, r_ui=3.0, est=2.857255358654782, details={'was_impossible': False}),\n",
       " Prediction(uid=72886, iid=2302, r_ui=2.0, est=3.459524623470632, details={'was_impossible': False}),\n",
       " Prediction(uid=144509, iid=70728, r_ui=0.5, est=3.6980256305583277, details={'was_impossible': False}),\n",
       " Prediction(uid=91212, iid=1394, r_ui=5.0, est=3.6771944277639297, details={'was_impossible': False}),\n",
       " Prediction(uid=42627, iid=1608, r_ui=4.0, est=3.6214091286635903, details={'was_impossible': False}),\n",
       " Prediction(uid=80705, iid=8644, r_ui=3.5, est=3.173375572449905, details={'was_impossible': False}),\n",
       " Prediction(uid=14409, iid=1227, r_ui=4.5, est=3.6429846170060625, details={'was_impossible': False}),\n",
       " Prediction(uid=160473, iid=166568, r_ui=3.5, est=3.3914610218565815, details={'was_impossible': False}),\n",
       " Prediction(uid=8879, iid=3355, r_ui=2.5, est=3.061535701228731, details={'was_impossible': False}),\n",
       " Prediction(uid=32388, iid=2700, r_ui=3.5, est=3.516592442824735, details={'was_impossible': False}),\n",
       " Prediction(uid=134185, iid=122918, r_ui=4.0, est=3.6131032332630038, details={'was_impossible': False}),\n",
       " Prediction(uid=30949, iid=60074, r_ui=3.5, est=3.4563116506282174, details={'was_impossible': False}),\n",
       " Prediction(uid=139236, iid=247, r_ui=5.0, est=3.6861851690752068, details={'was_impossible': False}),\n",
       " Prediction(uid=1854, iid=1213, r_ui=4.0, est=4.2161618324279235, details={'was_impossible': False}),\n",
       " Prediction(uid=82072, iid=122882, r_ui=4.0, est=3.8272341308754028, details={'was_impossible': False}),\n",
       " Prediction(uid=103011, iid=2798, r_ui=0.5, est=2.6946259812076128, details={'was_impossible': False}),\n",
       " Prediction(uid=62946, iid=3328, r_ui=3.0, est=3.5077017470072556, details={'was_impossible': False}),\n",
       " Prediction(uid=60287, iid=899, r_ui=5.0, est=3.9473981180976874, details={'was_impossible': False}),\n",
       " Prediction(uid=56630, iid=1573, r_ui=3.0, est=3.4130932760314954, details={'was_impossible': False}),\n",
       " Prediction(uid=98227, iid=7329, r_ui=1.5, est=3.581098745910151, details={'was_impossible': False}),\n",
       " Prediction(uid=9580, iid=6410, r_ui=2.5, est=3.262965298001699, details={'was_impossible': False}),\n",
       " Prediction(uid=118173, iid=63, r_ui=5.0, est=3.1521660659178012, details={'was_impossible': False}),\n",
       " Prediction(uid=14257, iid=106489, r_ui=5.0, est=3.6757556324274288, details={'was_impossible': False}),\n",
       " Prediction(uid=155163, iid=193477, r_ui=4.5, est=3.479648819324671, details={'was_impossible': False}),\n",
       " Prediction(uid=28780, iid=7445, r_ui=3.5, est=3.4077419190553475, details={'was_impossible': False}),\n",
       " Prediction(uid=15837, iid=260, r_ui=4.5, est=3.9221006291113225, details={'was_impossible': False}),\n",
       " Prediction(uid=29803, iid=2470, r_ui=2.0, est=2.266754258674857, details={'was_impossible': False}),\n",
       " Prediction(uid=43939, iid=2329, r_ui=4.5, est=4.220166766645319, details={'was_impossible': False}),\n",
       " Prediction(uid=129435, iid=4014, r_ui=3.0, est=3.5228285608441174, details={'was_impossible': False}),\n",
       " Prediction(uid=25245, iid=357, r_ui=3.0, est=3.488626773063525, details={'was_impossible': False}),\n",
       " Prediction(uid=16179, iid=4890, r_ui=3.0, est=3.0885474150820853, details={'was_impossible': False}),\n",
       " Prediction(uid=803, iid=1408, r_ui=4.0, est=3.1975149976450274, details={'was_impossible': False}),\n",
       " Prediction(uid=55095, iid=2889, r_ui=1.0, est=3.690006923296301, details={'was_impossible': False}),\n",
       " Prediction(uid=85124, iid=1374, r_ui=4.0, est=3.742086865761757, details={'was_impossible': False}),\n",
       " Prediction(uid=35293, iid=68848, r_ui=4.0, est=3.174386757271708, details={'was_impossible': False}),\n",
       " Prediction(uid=63257, iid=173, r_ui=2.5, est=2.6435680702875115, details={'was_impossible': False}),\n",
       " Prediction(uid=61109, iid=32298, r_ui=1.5, est=2.5148333864985575, details={'was_impossible': False}),\n",
       " Prediction(uid=91529, iid=122906, r_ui=3.5, est=3.873021968411987, details={'was_impossible': False}),\n",
       " Prediction(uid=110404, iid=367, r_ui=4.0, est=2.8721527574681938, details={'was_impossible': False}),\n",
       " Prediction(uid=29484, iid=2231, r_ui=3.0, est=3.789464883262602, details={'was_impossible': False}),\n",
       " Prediction(uid=7653, iid=2571, r_ui=3.0, est=3.952091102607528, details={'was_impossible': False}),\n",
       " Prediction(uid=146598, iid=6157, r_ui=2.0, est=2.3556285197592484, details={'was_impossible': False}),\n",
       " Prediction(uid=72902, iid=8636, r_ui=3.0, est=3.3985484864336972, details={'was_impossible': False}),\n",
       " Prediction(uid=94174, iid=2959, r_ui=5.0, est=4.104371846247109, details={'was_impossible': False}),\n",
       " Prediction(uid=127826, iid=2083, r_ui=4.0, est=3.4520807409952954, details={'was_impossible': False}),\n",
       " Prediction(uid=84393, iid=2470, r_ui=1.5, est=3.1036717863912355, details={'was_impossible': False}),\n",
       " Prediction(uid=65526, iid=5064, r_ui=4.0, est=3.6289341311740944, details={'was_impossible': False}),\n",
       " Prediction(uid=140448, iid=108932, r_ui=3.5, est=3.06797738277182, details={'was_impossible': False}),\n",
       " Prediction(uid=145457, iid=8966, r_ui=5.0, est=3.406095753704657, details={'was_impossible': False}),\n",
       " Prediction(uid=30094, iid=1380, r_ui=3.5, est=3.4764338263880195, details={'was_impossible': False}),\n",
       " Prediction(uid=156462, iid=349, r_ui=3.5, est=3.4433853912241648, details={'was_impossible': False}),\n",
       " Prediction(uid=149665, iid=300, r_ui=3.0, est=3.64506749774106, details={'was_impossible': False}),\n",
       " Prediction(uid=139024, iid=92420, r_ui=3.5, est=3.0438438540396344, details={'was_impossible': False}),\n",
       " Prediction(uid=144948, iid=2153, r_ui=3.0, est=2.3094018081679435, details={'was_impossible': False}),\n",
       " Prediction(uid=17512, iid=96417, r_ui=3.5, est=3.514865217673589, details={'was_impossible': False}),\n",
       " Prediction(uid=157348, iid=2116, r_ui=3.0, est=3.604380728180504, details={'was_impossible': False}),\n",
       " Prediction(uid=118959, iid=1644, r_ui=3.0, est=2.7872799851325345, details={'was_impossible': False}),\n",
       " Prediction(uid=43715, iid=296, r_ui=4.5, est=3.9046172153780203, details={'was_impossible': False}),\n",
       " Prediction(uid=131583, iid=1760, r_ui=2.0, est=2.7720861246475947, details={'was_impossible': False}),\n",
       " Prediction(uid=113784, iid=38061, r_ui=4.0, est=3.676663971811021, details={'was_impossible': False}),\n",
       " Prediction(uid=14059, iid=6294, r_ui=4.0, est=3.3674231842965914, details={'was_impossible': False}),\n",
       " Prediction(uid=99547, iid=3978, r_ui=2.5, est=2.820664633399395, details={'was_impossible': False}),\n",
       " Prediction(uid=37097, iid=4422, r_ui=4.0, est=3.462556914933215, details={'was_impossible': False}),\n",
       " Prediction(uid=133318, iid=778, r_ui=4.0, est=4.001377470706637, details={'was_impossible': False}),\n",
       " Prediction(uid=13848, iid=4734, r_ui=2.5, est=3.3241065081804906, details={'was_impossible': False}),\n",
       " Prediction(uid=9888, iid=134130, r_ui=4.0, est=3.775080033960335, details={'was_impossible': False}),\n",
       " Prediction(uid=20584, iid=3147, r_ui=4.0, est=3.9050475850085995, details={'was_impossible': False}),\n",
       " Prediction(uid=55219, iid=1037, r_ui=2.0, est=3.1120164926525113, details={'was_impossible': False}),\n",
       " Prediction(uid=103948, iid=71520, r_ui=2.0, est=2.5273174087186367, details={'was_impossible': False}),\n",
       " Prediction(uid=56143, iid=1909, r_ui=3.0, est=3.262748993572369, details={'was_impossible': False}),\n",
       " Prediction(uid=16574, iid=3092, r_ui=3.0, est=3.491688364576348, details={'was_impossible': False}),\n",
       " Prediction(uid=31720, iid=140162, r_ui=3.5, est=2.8890316134411216, details={'was_impossible': False}),\n",
       " Prediction(uid=37119, iid=2054, r_ui=3.0, est=2.385663979574476, details={'was_impossible': False}),\n",
       " Prediction(uid=77501, iid=42732, r_ui=5.0, est=3.535214285714286, details={'was_impossible': False}),\n",
       " Prediction(uid=144341, iid=55282, r_ui=3.0, est=3.152368431195115, details={'was_impossible': False}),\n",
       " Prediction(uid=48838, iid=1204, r_ui=4.0, est=4.024082700364922, details={'was_impossible': False}),\n",
       " Prediction(uid=7323, iid=2959, r_ui=4.5, est=4.006956714761936, details={'was_impossible': False}),\n",
       " Prediction(uid=117160, iid=1223, r_ui=4.5, est=3.718744896830496, details={'was_impossible': False}),\n",
       " Prediction(uid=133057, iid=178061, r_ui=3.5, est=4.092574136073047, details={'was_impossible': False}),\n",
       " Prediction(uid=71961, iid=205, r_ui=2.0, est=3.5282210492512327, details={'was_impossible': False}),\n",
       " Prediction(uid=31207, iid=4027, r_ui=3.0, est=3.5797353372382323, details={'was_impossible': False}),\n",
       " Prediction(uid=90368, iid=58559, r_ui=5.0, est=4.221842299778028, details={'was_impossible': False}),\n",
       " Prediction(uid=22057, iid=1214, r_ui=5.0, est=4.0753975437841925, details={'was_impossible': False}),\n",
       " Prediction(uid=8482, iid=111663, r_ui=3.0, est=3.238508458158733, details={'was_impossible': False}),\n",
       " Prediction(uid=52468, iid=173429, r_ui=4.0, est=3.161516472026446, details={'was_impossible': False}),\n",
       " Prediction(uid=11952, iid=2471, r_ui=3.5, est=2.432430473967228, details={'was_impossible': False}),\n",
       " Prediction(uid=154588, iid=3753, r_ui=3.5, est=3.3231314193821637, details={'was_impossible': False}),\n",
       " Prediction(uid=7834, iid=8958, r_ui=3.5, est=3.864853029175921, details={'was_impossible': False}),\n",
       " Prediction(uid=35209, iid=3863, r_ui=3.5, est=3.1195382651229515, details={'was_impossible': False}),\n",
       " Prediction(uid=13818, iid=1136, r_ui=5.0, est=3.9423914769347146, details={'was_impossible': False}),\n",
       " Prediction(uid=105316, iid=1127, r_ui=2.5, est=3.7306904898412796, details={'was_impossible': False}),\n",
       " Prediction(uid=15806, iid=259, r_ui=3.5, est=3.4653853811282564, details={'was_impossible': False}),\n",
       " Prediction(uid=54088, iid=1219, r_ui=2.5, est=3.788244076079831, details={'was_impossible': False}),\n",
       " Prediction(uid=96818, iid=3624, r_ui=1.5, est=2.543988017122059, details={'was_impossible': False}),\n",
       " Prediction(uid=42428, iid=2366, r_ui=5.0, est=3.5697143998703313, details={'was_impossible': False}),\n",
       " Prediction(uid=77084, iid=64614, r_ui=5.0, est=3.741707777948782, details={'was_impossible': False}),\n",
       " Prediction(uid=103531, iid=2275, r_ui=2.0, est=3.628346482687558, details={'was_impossible': False}),\n",
       " Prediction(uid=125565, iid=8949, r_ui=1.5, est=3.250876921897015, details={'was_impossible': False}),\n",
       " Prediction(uid=87568, iid=3253, r_ui=4.0, est=3.539899750722672, details={'was_impossible': False}),\n",
       " Prediction(uid=44692, iid=26084, r_ui=4.5, est=3.7502213039674688, details={'was_impossible': False}),\n",
       " Prediction(uid=53666, iid=77866, r_ui=4.0, est=3.360754256068393, details={'was_impossible': False}),\n",
       " Prediction(uid=145654, iid=1270, r_ui=3.0, est=3.806830792065901, details={'was_impossible': False}),\n",
       " Prediction(uid=38841, iid=377, r_ui=3.0, est=3.4682314897317834, details={'was_impossible': False}),\n",
       " Prediction(uid=130425, iid=2858, r_ui=4.0, est=3.990567984730193, details={'was_impossible': False}),\n",
       " Prediction(uid=65063, iid=115569, r_ui=5.0, est=3.8770029608635843, details={'was_impossible': False}),\n",
       " Prediction(uid=82257, iid=50, r_ui=4.5, est=3.951783242821202, details={'was_impossible': False}),\n",
       " Prediction(uid=146230, iid=1917, r_ui=1.5, est=3.1612209635964303, details={'was_impossible': False}),\n",
       " Prediction(uid=40858, iid=4155, r_ui=1.0, est=3.244964611712029, details={'was_impossible': False}),\n",
       " Prediction(uid=40636, iid=2290, r_ui=3.0, est=2.990543770888416, details={'was_impossible': False}),\n",
       " Prediction(uid=4675, iid=2321, r_ui=4.0, est=3.293108853055461, details={'was_impossible': False}),\n",
       " Prediction(uid=64574, iid=3578, r_ui=4.5, est=3.8190343205662014, details={'was_impossible': False}),\n",
       " Prediction(uid=90067, iid=316, r_ui=3.0, est=3.4074034705226697, details={'was_impossible': False}),\n",
       " Prediction(uid=28487, iid=2940, r_ui=3.0, est=3.7005174347777015, details={'was_impossible': False}),\n",
       " Prediction(uid=74354, iid=1097, r_ui=4.0, est=3.625098732649613, details={'was_impossible': False}),\n",
       " Prediction(uid=60070, iid=1831, r_ui=2.5, est=3.2951758458100726, details={'was_impossible': False}),\n",
       " Prediction(uid=24832, iid=1193, r_ui=4.5, est=3.8738529134287223, details={'was_impossible': False}),\n",
       " Prediction(uid=52708, iid=115149, r_ui=4.0, est=3.856306292324647, details={'was_impossible': False}),\n",
       " Prediction(uid=19826, iid=3174, r_ui=3.5, est=3.3042667769489067, details={'was_impossible': False}),\n",
       " Prediction(uid=46740, iid=4085, r_ui=2.5, est=3.8178941045078463, details={'was_impossible': False}),\n",
       " Prediction(uid=60655, iid=1959, r_ui=3.5, est=3.024276787760581, details={'was_impossible': False}),\n",
       " Prediction(uid=44863, iid=53894, r_ui=3.5, est=3.8044413168237243, details={'was_impossible': False}),\n",
       " Prediction(uid=66141, iid=33679, r_ui=3.0, est=3.5901341900337136, details={'was_impossible': False}),\n",
       " Prediction(uid=43774, iid=282, r_ui=4.0, est=3.5672088778221047, details={'was_impossible': False}),\n",
       " Prediction(uid=57702, iid=1198, r_ui=4.0, est=4.061504830179716, details={'was_impossible': False}),\n",
       " Prediction(uid=152532, iid=1394, r_ui=5.0, est=3.769112576398891, details={'was_impossible': False}),\n",
       " Prediction(uid=116376, iid=2065, r_ui=3.0, est=3.4561583225072146, details={'was_impossible': False}),\n",
       " Prediction(uid=157600, iid=48394, r_ui=4.5, est=4.010418796854706, details={'was_impossible': False}),\n",
       " Prediction(uid=69404, iid=32019, r_ui=3.0, est=3.2671912640153034, details={'was_impossible': False}),\n",
       " Prediction(uid=144971, iid=589, r_ui=4.0, est=3.942223404735326, details={'was_impossible': False}),\n",
       " Prediction(uid=39584, iid=8961, r_ui=4.0, est=3.8087286822643436, details={'was_impossible': False}),\n",
       " Prediction(uid=126466, iid=3740, r_ui=5.0, est=3.722296207951298, details={'was_impossible': False}),\n",
       " Prediction(uid=28235, iid=2767, r_ui=4.0, est=3.535214285714286, details={'was_impossible': False}),\n",
       " Prediction(uid=83458, iid=5378, r_ui=4.0, est=3.3004830249149797, details={'was_impossible': False}),\n",
       " Prediction(uid=32431, iid=6789, r_ui=3.5, est=3.277885445684932, details={'was_impossible': False}),\n",
       " Prediction(uid=115575, iid=7005, r_ui=2.0, est=3.2088083970744172, details={'was_impossible': False}),\n",
       " Prediction(uid=105191, iid=480, r_ui=3.0, est=3.779505660736089, details={'was_impossible': False}),\n",
       " Prediction(uid=74097, iid=5502, r_ui=2.0, est=3.0254923893395613, details={'was_impossible': False}),\n",
       " Prediction(uid=66186, iid=3727, r_ui=3.5, est=3.5810658067491854, details={'was_impossible': False}),\n",
       " Prediction(uid=5183, iid=74530, r_ui=4.0, est=3.6340325900850874, details={'was_impossible': False}),\n",
       " Prediction(uid=100326, iid=86882, r_ui=4.5, est=3.985535346469444, details={'was_impossible': False}),\n",
       " Prediction(uid=65538, iid=2986, r_ui=2.0, est=3.1809843693040682, details={'was_impossible': False}),\n",
       " Prediction(uid=34071, iid=79318, r_ui=4.5, est=3.5251611929799287, details={'was_impossible': False}),\n",
       " Prediction(uid=121678, iid=1208, r_ui=4.5, est=4.378187956844236, details={'was_impossible': False}),\n",
       " Prediction(uid=11351, iid=1183, r_ui=4.0, est=3.7956458279326837, details={'was_impossible': False}),\n",
       " Prediction(uid=17641, iid=4084, r_ui=4.5, est=3.3839304305057785, details={'was_impossible': False}),\n",
       " Prediction(uid=119382, iid=4874, r_ui=4.0, est=3.6402108586529396, details={'was_impossible': False}),\n",
       " Prediction(uid=81979, iid=2872, r_ui=4.0, est=3.7355960546494043, details={'was_impossible': False}),\n",
       " Prediction(uid=18231, iid=2671, r_ui=4.0, est=3.1853925955791293, details={'was_impossible': False}),\n",
       " Prediction(uid=128467, iid=3744, r_ui=2.0, est=3.4695528167755683, details={'was_impossible': False}),\n",
       " Prediction(uid=122951, iid=30825, r_ui=2.5, est=3.6240843489734047, details={'was_impossible': False}),\n",
       " Prediction(uid=60971, iid=3499, r_ui=4.0, est=3.6069676967863806, details={'was_impossible': False}),\n",
       " Prediction(uid=56076, iid=1162, r_ui=3.0, est=3.9732110888881413, details={'was_impossible': False}),\n",
       " Prediction(uid=50650, iid=69481, r_ui=4.0, est=3.6557129110350184, details={'was_impossible': False}),\n",
       " Prediction(uid=59774, iid=3275, r_ui=3.0, est=3.7669264551714368, details={'was_impossible': False}),\n",
       " Prediction(uid=99766, iid=3013, r_ui=3.5, est=3.468913498261917, details={'was_impossible': False}),\n",
       " Prediction(uid=104390, iid=261, r_ui=3.0, est=3.782821057034032, details={'was_impossible': False}),\n",
       " Prediction(uid=85343, iid=44022, r_ui=4.0, est=3.2122738920150904, details={'was_impossible': False}),\n",
       " Prediction(uid=92692, iid=164179, r_ui=4.0, est=3.9119521478867596, details={'was_impossible': False}),\n",
       " Prediction(uid=159487, iid=3996, r_ui=4.5, est=3.598509007245992, details={'was_impossible': False}),\n",
       " Prediction(uid=148368, iid=455, r_ui=5.0, est=3.0320748993988094, details={'was_impossible': False}),\n",
       " Prediction(uid=146966, iid=1537, r_ui=5.0, est=3.5930328064240484, details={'was_impossible': False}),\n",
       " Prediction(uid=95620, iid=12, r_ui=2.0, est=3.1712527243491784, details={'was_impossible': False}),\n",
       " Prediction(uid=50739, iid=168, r_ui=4.0, est=3.2936090106476366, details={'was_impossible': False}),\n",
       " Prediction(uid=82187, iid=2890, r_ui=3.5, est=4.099726613972271, details={'was_impossible': False}),\n",
       " Prediction(uid=118253, iid=79132, r_ui=4.5, est=4.065603304795347, details={'was_impossible': False}),\n",
       " Prediction(uid=49223, iid=1321, r_ui=2.0, est=3.6881633878263393, details={'was_impossible': False}),\n",
       " Prediction(uid=56440, iid=7323, r_ui=4.5, est=3.9901497602780647, details={'was_impossible': False}),\n",
       " Prediction(uid=86686, iid=788, r_ui=3.0, est=2.583340562666004, details={'was_impossible': False}),\n",
       " Prediction(uid=77543, iid=5679, r_ui=4.0, est=3.465920092721348, details={'was_impossible': False}),\n",
       " Prediction(uid=146569, iid=246, r_ui=5.0, est=3.7822360195819047, details={'was_impossible': False}),\n",
       " Prediction(uid=61912, iid=6794, r_ui=3.0, est=2.6448026192503677, details={'was_impossible': False}),\n",
       " Prediction(uid=46757, iid=2491, r_ui=2.5, est=3.647185229923612, details={'was_impossible': False}),\n",
       " Prediction(uid=13707, iid=2959, r_ui=4.0, est=4.104371846247109, details={'was_impossible': False}),\n",
       " Prediction(uid=57145, iid=185, r_ui=3.0, est=3.503432002945948, details={'was_impossible': False}),\n",
       " Prediction(uid=55009, iid=2571, r_ui=4.0, est=3.969686656240947, details={'was_impossible': False}),\n",
       " Prediction(uid=52809, iid=60069, r_ui=4.0, est=3.9156623773345336, details={'was_impossible': False}),\n",
       " Prediction(uid=15820, iid=4886, r_ui=5.0, est=3.7442345487233855, details={'was_impossible': False}),\n",
       " Prediction(uid=139076, iid=2599, r_ui=4.0, est=3.3204386406304938, details={'was_impossible': False}),\n",
       " Prediction(uid=119505, iid=5064, r_ui=5.0, est=3.6831498403252905, details={'was_impossible': False}),\n",
       " Prediction(uid=92041, iid=68358, r_ui=3.0, est=3.1452749784856238, details={'was_impossible': False}),\n",
       " Prediction(uid=121374, iid=986, r_ui=5.0, est=3.441792341250017, details={'was_impossible': False}),\n",
       " Prediction(uid=116321, iid=2143, r_ui=2.0, est=3.301994640447898, details={'was_impossible': False}),\n",
       " Prediction(uid=125882, iid=1028, r_ui=3.5, est=3.7359241436697355, details={'was_impossible': False}),\n",
       " Prediction(uid=22833, iid=2490, r_ui=3.0, est=3.661787094846852, details={'was_impossible': False}),\n",
       " Prediction(uid=152086, iid=59900, r_ui=0.5, est=2.64930020884488, details={'was_impossible': False}),\n",
       " Prediction(uid=16678, iid=2713, r_ui=2.0, est=3.495746540612298, details={'was_impossible': False}),\n",
       " Prediction(uid=155163, iid=159858, r_ui=4.0, est=3.6168664778096034, details={'was_impossible': False}),\n",
       " Prediction(uid=129668, iid=51255, r_ui=4.5, est=3.7014014415477052, details={'was_impossible': False}),\n",
       " Prediction(uid=54071, iid=6218, r_ui=4.0, est=3.061295875641558, details={'was_impossible': False}),\n",
       " Prediction(uid=54616, iid=507, r_ui=3.0, est=3.654010632336094, details={'was_impossible': False}),\n",
       " Prediction(uid=109603, iid=1370, r_ui=5.0, est=3.4571187728051567, details={'was_impossible': False}),\n",
       " Prediction(uid=92278, iid=185, r_ui=3.0, est=3.439840946085353, details={'was_impossible': False}),\n",
       " Prediction(uid=107412, iid=1588, r_ui=5.0, est=3.0073213625691664, details={'was_impossible': False}),\n",
       " Prediction(uid=82997, iid=1862, r_ui=1.0, est=3.135295386075353, details={'was_impossible': False}),\n",
       " Prediction(uid=35622, iid=26, r_ui=3.0, est=3.2404758786090846, details={'was_impossible': False}),\n",
       " Prediction(uid=74966, iid=2268, r_ui=4.0, est=3.782882145913025, details={'was_impossible': False}),\n",
       " Prediction(uid=19997, iid=174477, r_ui=2.0, est=3.898230586819557, details={'was_impossible': False}),\n",
       " Prediction(uid=114642, iid=1517, r_ui=4.0, est=3.4299143198108113, details={'was_impossible': False}),\n",
       " Prediction(uid=43521, iid=3646, r_ui=1.5, est=2.83526356665898, details={'was_impossible': False}),\n",
       " Prediction(uid=62524, iid=132796, r_ui=1.0, est=3.0649673360993175, details={'was_impossible': False}),\n",
       " Prediction(uid=73268, iid=144224, r_ui=0.5, est=2.4728979631498937, details={'was_impossible': False}),\n",
       " Prediction(uid=64366, iid=7123, r_ui=4.0, est=3.7968796861565615, details={'was_impossible': False}),\n",
       " Prediction(uid=89308, iid=4447, r_ui=4.0, est=3.4608902350653175, details={'was_impossible': False}),\n",
       " Prediction(uid=34646, iid=3578, r_ui=5.0, est=3.8190343205662014, details={'was_impossible': False}),\n",
       " Prediction(uid=10033, iid=1247, r_ui=3.5, est=4.087454518313083, details={'was_impossible': False}),\n",
       " Prediction(uid=47782, iid=47, r_ui=4.0, est=4.327326540250672, details={'was_impossible': False}),\n",
       " Prediction(uid=60861, iid=4372, r_ui=4.0, est=3.172783535478754, details={'was_impossible': False}),\n",
       " Prediction(uid=71538, iid=32, r_ui=1.0, est=3.831507493872022, details={'was_impossible': False}),\n",
       " Prediction(uid=23444, iid=2761, r_ui=3.0, est=3.9230322896352043, details={'was_impossible': False}),\n",
       " Prediction(uid=32398, iid=345, r_ui=5.0, est=3.9083373146941325, details={'was_impossible': False}),\n",
       " Prediction(uid=64497, iid=737, r_ui=1.0, est=3.124342476020893, details={'was_impossible': False}),\n",
       " Prediction(uid=157730, iid=608, r_ui=4.5, est=4.034576038283447, details={'was_impossible': False}),\n",
       " Prediction(uid=27411, iid=3173, r_ui=2.0, est=3.6609841553935842, details={'was_impossible': False}),\n",
       " Prediction(uid=86192, iid=1939, r_ui=4.5, est=3.23269546535661, details={'was_impossible': False}),\n",
       " Prediction(uid=36450, iid=59369, r_ui=5.0, est=3.845290328139349, details={'was_impossible': False}),\n",
       " Prediction(uid=1920, iid=2460, r_ui=2.5, est=3.007675922426547, details={'was_impossible': False}),\n",
       " Prediction(uid=83605, iid=344, r_ui=5.0, est=3.151890091902908, details={'was_impossible': False}),\n",
       " Prediction(uid=122606, iid=2105, r_ui=4.0, est=3.346538727948525, details={'was_impossible': False}),\n",
       " Prediction(uid=160135, iid=2718, r_ui=2.0, est=3.4704520304909936, details={'was_impossible': False}),\n",
       " Prediction(uid=78308, iid=4792, r_ui=2.5, est=3.073151555235542, details={'was_impossible': False}),\n",
       " Prediction(uid=22517, iid=586, r_ui=4.0, est=3.2700516055147575, details={'was_impossible': False}),\n",
       " Prediction(uid=30981, iid=3267, r_ui=4.0, est=3.962953381589702, details={'was_impossible': False}),\n",
       " Prediction(uid=44242, iid=32, r_ui=5.0, est=3.7359969784531213, details={'was_impossible': False}),\n",
       " Prediction(uid=55998, iid=2858, r_ui=5.0, est=3.990567984730193, details={'was_impossible': False}),\n",
       " Prediction(uid=39473, iid=2650, r_ui=4.0, est=3.481625691379819, details={'was_impossible': False}),\n",
       " Prediction(uid=112971, iid=109864, r_ui=1.5, est=3.204248871562654, details={'was_impossible': False}),\n",
       " Prediction(uid=155025, iid=4954, r_ui=3.0, est=3.385151335128547, details={'was_impossible': False}),\n",
       " Prediction(uid=44581, iid=2338, r_ui=4.0, est=2.4031291836201123, details={'was_impossible': False}),\n",
       " Prediction(uid=90121, iid=2087, r_ui=4.5, est=3.6659530479390847, details={'was_impossible': False}),\n",
       " Prediction(uid=144695, iid=380, r_ui=3.0, est=3.434938248798689, details={'was_impossible': False}),\n",
       " Prediction(uid=78620, iid=1249, r_ui=4.0, est=3.8997736274950334, details={'was_impossible': False}),\n",
       " Prediction(uid=70988, iid=94959, r_ui=4.0, est=3.81523752899169, details={'was_impossible': False}),\n",
       " Prediction(uid=131856, iid=2353, r_ui=3.0, est=3.6017560739754755, details={'was_impossible': False}),\n",
       " Prediction(uid=76875, iid=127198, r_ui=3.5, est=3.5494860859508295, details={'was_impossible': False}),\n",
       " Prediction(uid=111918, iid=55063, r_ui=4.5, est=3.881451128355393, details={'was_impossible': False}),\n",
       " Prediction(uid=49243, iid=413, r_ui=2.5, est=3.0376122924616826, details={'was_impossible': False}),\n",
       " Prediction(uid=38621, iid=318, r_ui=5.0, est=4.475154894856423, details={'was_impossible': False}),\n",
       " Prediction(uid=35797, iid=1385, r_ui=4.0, est=3.527229902222424, details={'was_impossible': False}),\n",
       " Prediction(uid=136615, iid=1035, r_ui=4.0, est=3.4556621031249373, details={'was_impossible': False}),\n",
       " Prediction(uid=94035, iid=5872, r_ui=4.0, est=3.2730414732387123, details={'was_impossible': False}),\n",
       " Prediction(uid=1222, iid=2314, r_ui=2.0, est=3.5156747570125866, details={'was_impossible': False}),\n",
       " Prediction(uid=32800, iid=6934, r_ui=3.5, est=3.1888790259656, details={'was_impossible': False}),\n",
       " Prediction(uid=65201, iid=3837, r_ui=3.0, est=3.4308716794519993, details={'was_impossible': False}),\n",
       " Prediction(uid=84254, iid=68073, r_ui=3.5, est=3.484471179215351, details={'was_impossible': False}),\n",
       " Prediction(uid=99565, iid=307, r_ui=4.0, est=3.805625927470521, details={'was_impossible': False}),\n",
       " Prediction(uid=108594, iid=7324, r_ui=3.0, est=3.6605837876989766, details={'was_impossible': False}),\n",
       " Prediction(uid=9391, iid=529, r_ui=4.0, est=3.8161043875003386, details={'was_impossible': False}),\n",
       " Prediction(uid=5367, iid=195, r_ui=4.0, est=3.35266423324697, details={'was_impossible': False}),\n",
       " Prediction(uid=78885, iid=266, r_ui=4.0, est=3.395475013284552, details={'was_impossible': False}),\n",
       " Prediction(uid=141135, iid=195, r_ui=3.0, est=3.4566683544114785, details={'was_impossible': False}),\n",
       " Prediction(uid=35719, iid=4249, r_ui=2.0, est=3.484793371141705, details={'was_impossible': False}),\n",
       " Prediction(uid=44270, iid=8368, r_ui=4.0, est=3.748993348219999, details={'was_impossible': False}),\n",
       " Prediction(uid=118810, iid=527, r_ui=5.0, est=4.040323950259012, details={'was_impossible': False}),\n",
       " Prediction(uid=154746, iid=5481, r_ui=3.5, est=3.4614193951239733, details={'was_impossible': False}),\n",
       " Prediction(uid=59930, iid=4890, r_ui=3.0, est=3.0168104199373875, details={'was_impossible': False}),\n",
       " Prediction(uid=35538, iid=1968, r_ui=2.0, est=3.800682518425929, details={'was_impossible': False}),\n",
       " Prediction(uid=47543, iid=17, r_ui=1.0, est=3.8188474691973604, details={'was_impossible': False}),\n",
       " Prediction(uid=159561, iid=1393, r_ui=3.0, est=3.614588089004986, details={'was_impossible': False}),\n",
       " Prediction(uid=87099, iid=1078, r_ui=4.5, est=3.5364819736667346, details={'was_impossible': False}),\n",
       " Prediction(uid=114726, iid=1213, r_ui=4.5, est=4.0579887243626835, details={'was_impossible': False}),\n",
       " Prediction(uid=114862, iid=47997, r_ui=4.0, est=3.621284597155838, details={'was_impossible': False}),\n",
       " Prediction(uid=42397, iid=4369, r_ui=3.0, est=3.1169599127646053, details={'was_impossible': False}),\n",
       " Prediction(uid=119237, iid=4973, r_ui=3.0, est=4.059531098089878, details={'was_impossible': False}),\n",
       " Prediction(uid=53146, iid=673, r_ui=3.0, est=2.869160715043931, details={'was_impossible': False}),\n",
       " Prediction(uid=147472, iid=91529, r_ui=5.0, est=3.749740079870312, details={'was_impossible': False}),\n",
       " Prediction(uid=36959, iid=3000, r_ui=3.5, est=3.9628488449658303, details={'was_impossible': False}),\n",
       " Prediction(uid=140606, iid=5147, r_ui=2.0, est=3.666257024423363, details={'was_impossible': False}),\n",
       " Prediction(uid=132029, iid=48780, r_ui=5.0, est=3.9018531066031072, details={'was_impossible': False}),\n",
       " Prediction(uid=60461, iid=74532, r_ui=4.0, est=3.4498620796784514, details={'was_impossible': False}),\n",
       " Prediction(uid=62266, iid=720, r_ui=3.0, est=3.933063497895515, details={'was_impossible': False}),\n",
       " Prediction(uid=130587, iid=6335, r_ui=3.0, est=3.547065610963334, details={'was_impossible': False}),\n",
       " Prediction(uid=31144, iid=225, r_ui=4.0, est=3.1078973850259857, details={'was_impossible': False}),\n",
       " Prediction(uid=41748, iid=593, r_ui=4.0, est=3.977554465146632, details={'was_impossible': False}),\n",
       " Prediction(uid=53781, iid=1994, r_ui=3.0, est=3.623289565552901, details={'was_impossible': False}),\n",
       " Prediction(uid=55172, iid=1909, r_ui=4.0, est=3.090690061865691, details={'was_impossible': False}),\n",
       " Prediction(uid=70461, iid=1091, r_ui=2.0, est=2.8821201222035344, details={'was_impossible': False}),\n",
       " Prediction(uid=46224, iid=2533, r_ui=1.0, est=3.2258579615787584, details={'was_impossible': False}),\n",
       " Prediction(uid=151316, iid=1445, r_ui=4.0, est=2.94631101795923, details={'was_impossible': False}),\n",
       " Prediction(uid=147810, iid=4082, r_ui=3.0, est=3.3710437123677544, details={'was_impossible': False}),\n",
       " Prediction(uid=124245, iid=115617, r_ui=4.5, est=3.703369381231374, details={'was_impossible': False}),\n",
       " Prediction(uid=42508, iid=1257, r_ui=1.0, est=3.935360231157999, details={'was_impossible': False}),\n",
       " Prediction(uid=137619, iid=189363, r_ui=3.5, est=3.6545572008037333, details={'was_impossible': False}),\n",
       " Prediction(uid=52970, iid=4135, r_ui=3.0, est=3.7226471831268064, details={'was_impossible': False}),\n",
       " Prediction(uid=50727, iid=40815, r_ui=2.5, est=3.5805550602546545, details={'was_impossible': False}),\n",
       " Prediction(uid=109686, iid=4016, r_ui=4.0, est=3.826108058816049, details={'was_impossible': False}),\n",
       " Prediction(uid=71451, iid=778, r_ui=3.5, est=3.402605594077659, details={'was_impossible': False}),\n",
       " Prediction(uid=60210, iid=150, r_ui=5.0, est=3.7052849135619157, details={'was_impossible': False}),\n",
       " Prediction(uid=95165, iid=4993, r_ui=4.0, est=3.864001402113336, details={'was_impossible': False}),\n",
       " Prediction(uid=120642, iid=4993, r_ui=5.0, est=3.864001402113336, details={'was_impossible': False}),\n",
       " Prediction(uid=78290, iid=84637, r_ui=4.0, est=3.2269424282028445, details={'was_impossible': False}),\n",
       " Prediction(uid=40571, iid=1876, r_ui=4.0, est=3.221722842403423, details={'was_impossible': False}),\n",
       " Prediction(uid=149385, iid=904, r_ui=4.0, est=4.032064564713669, details={'was_impossible': False}),\n",
       " Prediction(uid=92951, iid=3549, r_ui=5.0, est=3.6426201726379692, details={'was_impossible': False}),\n",
       " Prediction(uid=62756, iid=750, r_ui=5.0, est=4.130172876270104, details={'was_impossible': False}),\n",
       " Prediction(uid=60114, iid=8961, r_ui=4.0, est=3.7318932458683443, details={'was_impossible': False}),\n",
       " Prediction(uid=68804, iid=969, r_ui=5.0, est=4.124143928979124, details={'was_impossible': False}),\n",
       " Prediction(uid=36010, iid=4995, r_ui=3.0, est=3.773886865597454, details={'was_impossible': False}),\n",
       " Prediction(uid=68503, iid=1994, r_ui=2.5, est=3.510642856879454, details={'was_impossible': False}),\n",
       " Prediction(uid=152698, iid=78499, r_ui=4.5, est=3.8573509810600006, details={'was_impossible': False}),\n",
       " Prediction(uid=76209, iid=1203, r_ui=5.0, est=4.055061029402203, details={'was_impossible': False}),\n",
       " Prediction(uid=21247, iid=1628, r_ui=2.0, est=3.535214285714286, details={'was_impossible': False}),\n",
       " Prediction(uid=13896, iid=593, r_ui=5.0, est=3.977554465146632, details={'was_impossible': False}),\n",
       " Prediction(uid=99388, iid=1225, r_ui=4.0, est=3.8169347430489244, details={'was_impossible': False}),\n",
       " Prediction(uid=7673, iid=117176, r_ui=5.0, est=3.7199134633429667, details={'was_impossible': False}),\n",
       " Prediction(uid=105455, iid=40815, r_ui=3.5, est=3.5805550602546545, details={'was_impossible': False}),\n",
       " Prediction(uid=69920, iid=110, r_ui=4.5, est=3.7947455160063015, details={'was_impossible': False}),\n",
       " Prediction(uid=4635, iid=2953, r_ui=3.0, est=3.0451537653000624, details={'was_impossible': False}),\n",
       " Prediction(uid=111445, iid=3977, r_ui=2.5, est=2.9103007212064154, details={'was_impossible': False}),\n",
       " Prediction(uid=20943, iid=346, r_ui=3.5, est=3.700079957842285, details={'was_impossible': False}),\n",
       " Prediction(uid=102076, iid=1408, r_ui=4.0, est=3.456790408261568, details={'was_impossible': False}),\n",
       " Prediction(uid=135088, iid=1374, r_ui=3.5, est=3.7432391805756606, details={'was_impossible': False}),\n",
       " Prediction(uid=67516, iid=112552, r_ui=3.5, est=4.046663047286252, details={'was_impossible': False}),\n",
       " Prediction(uid=92284, iid=122892, r_ui=5.0, est=3.3218561942256, details={'was_impossible': False}),\n",
       " Prediction(uid=31456, iid=3994, r_ui=4.0, est=3.711430343779522, details={'was_impossible': False}),\n",
       " Prediction(uid=101738, iid=63131, r_ui=0.5, est=3.408021315932068, details={'was_impossible': False}),\n",
       " Prediction(uid=152934, iid=7980, r_ui=4.0, est=3.670571886804575, details={'was_impossible': False}),\n",
       " Prediction(uid=72222, iid=3555, r_ui=2.5, est=3.356011699708463, details={'was_impossible': False}),\n",
       " Prediction(uid=50773, iid=2570, r_ui=4.0, est=3.330171084724757, details={'was_impossible': False}),\n",
       " Prediction(uid=53815, iid=2078, r_ui=5.0, est=3.727370887745858, details={'was_impossible': False}),\n",
       " Prediction(uid=5189, iid=6, r_ui=3.0, est=3.7854650635918667, details={'was_impossible': False}),\n",
       " Prediction(uid=149957, iid=4993, r_ui=5.0, est=3.5573890592545383, details={'was_impossible': False}),\n",
       " Prediction(uid=150742, iid=33166, r_ui=3.0, est=3.496360299213941, details={'was_impossible': False}),\n",
       " Prediction(uid=107651, iid=2986, r_ui=2.0, est=3.1809843693040682, details={'was_impossible': False}),\n",
       " Prediction(uid=90677, iid=471, r_ui=4.0, est=3.6317768017143655, details={'was_impossible': False}),\n",
       " Prediction(uid=66121, iid=2005, r_ui=3.0, est=3.571966213090743, details={'was_impossible': False}),\n",
       " Prediction(uid=135367, iid=3508, r_ui=4.0, est=3.6213830644851663, details={'was_impossible': False}),\n",
       " Prediction(uid=150378, iid=440, r_ui=2.5, est=3.69617162748536, details={'was_impossible': False}),\n",
       " Prediction(uid=109013, iid=4487, r_ui=3.5, est=3.216894730486604, details={'was_impossible': False}),\n",
       " Prediction(uid=72130, iid=2541, r_ui=3.5, est=3.431937194177902, details={'was_impossible': False}),\n",
       " Prediction(uid=54421, iid=1175, r_ui=4.0, est=3.895481420944264, details={'was_impossible': False}),\n",
       " Prediction(uid=111311, iid=46572, r_ui=3.0, est=3.1340991760934807, details={'was_impossible': False}),\n",
       " Prediction(uid=38304, iid=368, r_ui=5.0, est=3.493200074547754, details={'was_impossible': False}),\n",
       " Prediction(uid=5764, iid=1129, r_ui=5.0, est=3.616430583302439, details={'was_impossible': False}),\n",
       " Prediction(uid=132531, iid=3949, r_ui=3.0, est=3.922226249558236, details={'was_impossible': False}),\n",
       " Prediction(uid=76750, iid=30793, r_ui=2.0, est=3.314179692640774, details={'was_impossible': False}),\n",
       " Prediction(uid=18408, iid=25, r_ui=4.0, est=3.842588198504376, details={'was_impossible': False}),\n",
       " Prediction(uid=60327, iid=45672, r_ui=4.0, est=2.834265698782918, details={'was_impossible': False}),\n",
       " Prediction(uid=110847, iid=135, r_ui=1.5, est=2.172137114325694, details={'was_impossible': False}),\n",
       " Prediction(uid=139038, iid=750, r_ui=3.0, est=4.138162121859837, details={'was_impossible': False}),\n",
       " Prediction(uid=58434, iid=273, r_ui=2.0, est=2.8534942632147455, details={'was_impossible': False}),\n",
       " Prediction(uid=41670, iid=4054, r_ui=3.0, est=3.1434143537218193, details={'was_impossible': False}),\n",
       " Prediction(uid=78962, iid=5669, r_ui=5.0, est=3.7937185354773106, details={'was_impossible': False}),\n",
       " Prediction(uid=50767, iid=1037, r_ui=2.0, est=2.825722278942106, details={'was_impossible': False}),\n",
       " Prediction(uid=154045, iid=104, r_ui=5.0, est=3.1343090514665577, details={'was_impossible': False}),\n",
       " Prediction(uid=150083, iid=541, r_ui=3.5, est=4.106130444743912, details={'was_impossible': False}),\n",
       " Prediction(uid=17135, iid=260, r_ui=0.5, est=3.9221006291113225, details={'was_impossible': False}),\n",
       " Prediction(uid=133442, iid=1348, r_ui=5.0, est=3.935165216778729, details={'was_impossible': False}),\n",
       " Prediction(uid=10106, iid=2702, r_ui=2.5, est=2.627192264731582, details={'was_impossible': False}),\n",
       " Prediction(uid=105321, iid=6374, r_ui=0.5, est=3.6185560348024435, details={'was_impossible': False}),\n",
       " Prediction(uid=116341, iid=410, r_ui=4.0, est=3.0283268834238006, details={'was_impossible': False}),\n",
       " Prediction(uid=72784, iid=569, r_ui=3.0, est=3.2515398159911593, details={'was_impossible': False}),\n",
       " Prediction(uid=44459, iid=733, r_ui=4.0, est=3.673608154143342, details={'was_impossible': False}),\n",
       " Prediction(uid=107464, iid=1580, r_ui=4.0, est=3.5084240433760896, details={'was_impossible': False}),\n",
       " Prediction(uid=18242, iid=1304, r_ui=4.0, est=3.9674645875295758, details={'was_impossible': False}),\n",
       " Prediction(uid=102578, iid=61350, r_ui=1.0, est=3.0890627237902946, details={'was_impossible': False}),\n",
       " Prediction(uid=7232, iid=45501, r_ui=3.5, est=3.033249673651709, details={'was_impossible': False}),\n",
       " Prediction(uid=121089, iid=1407, r_ui=3.0, est=3.322790330992818, details={'was_impossible': False}),\n",
       " Prediction(uid=154664, iid=4776, r_ui=4.0, est=3.7952023553295873, details={'was_impossible': False}),\n",
       " Prediction(uid=33306, iid=589, r_ui=5.0, est=3.942223404735326, details={'was_impossible': False}),\n",
       " Prediction(uid=28907, iid=4973, r_ui=5.0, est=4.059531098089878, details={'was_impossible': False}),\n",
       " Prediction(uid=25441, iid=24, r_ui=4.0, est=3.2284399185513277, details={'was_impossible': False}),\n",
       " Prediction(uid=24511, iid=2410, r_ui=2.0, est=3.1841934900882665, details={'was_impossible': False}),\n",
       " Prediction(uid=20332, iid=2764, r_ui=4.0, est=3.4994849956298677, details={'was_impossible': False}),\n",
       " Prediction(uid=131541, iid=1345, r_ui=4.0, est=3.428865036760036, details={'was_impossible': False}),\n",
       " Prediction(uid=153731, iid=2714, r_ui=4.0, est=3.493587071405819, details={'was_impossible': False}),\n",
       " Prediction(uid=74755, iid=592, r_ui=3.0, est=3.5587359107403036, details={'was_impossible': False}),\n",
       " Prediction(uid=7341, iid=4963, r_ui=4.0, est=3.753213301392334, details={'was_impossible': False}),\n",
       " Prediction(uid=48276, iid=1997, r_ui=4.0, est=3.9386171388512774, details={'was_impossible': False}),\n",
       " Prediction(uid=78604, iid=1704, r_ui=3.0, est=3.8386637484997546, details={'was_impossible': False}),\n",
       " Prediction(uid=36617, iid=79132, r_ui=2.5, est=4.1822039234983635, details={'was_impossible': False}),\n",
       " Prediction(uid=93468, iid=145, r_ui=3.0, est=3.623602162924827, details={'was_impossible': False}),\n",
       " Prediction(uid=53014, iid=51077, r_ui=2.0, est=2.7629229634045025, details={'was_impossible': False}),\n",
       " Prediction(uid=79201, iid=2058, r_ui=4.0, est=3.389339149784532, details={'was_impossible': False}),\n",
       " Prediction(uid=149105, iid=2716, r_ui=4.0, est=3.868442611047285, details={'was_impossible': False}),\n",
       " Prediction(uid=23080, iid=356, r_ui=3.5, est=3.8748653707619605, details={'was_impossible': False}),\n",
       " Prediction(uid=19269, iid=1088, r_ui=3.5, est=3.3441211180649857, details={'was_impossible': False}),\n",
       " Prediction(uid=63591, iid=6754, r_ui=2.5, est=2.693921431842175, details={'was_impossible': False}),\n",
       " Prediction(uid=140852, iid=168, r_ui=4.0, est=3.264733997679524, details={'was_impossible': False}),\n",
       " Prediction(uid=120115, iid=112, r_ui=4.0, est=3.5638552748710004, details={'was_impossible': False}),\n",
       " Prediction(uid=30667, iid=1043, r_ui=3.0, est=3.1252558215071544, details={'was_impossible': False}),\n",
       " Prediction(uid=72356, iid=57439, r_ui=4.0, est=3.526992652708933, details={'was_impossible': False}),\n",
       " Prediction(uid=37097, iid=1927, r_ui=4.0, est=3.765785385969291, details={'was_impossible': False}),\n",
       " Prediction(uid=29543, iid=139644, r_ui=4.0, est=3.526220965662887, details={'was_impossible': False}),\n",
       " Prediction(uid=99342, iid=3747, r_ui=3.0, est=3.2084556819707126, details={'was_impossible': False}),\n",
       " Prediction(uid=16388, iid=5989, r_ui=4.0, est=3.7979088758803985, details={'was_impossible': False}),\n",
       " Prediction(uid=16211, iid=948, r_ui=3.0, est=3.859508165867613, details={'was_impossible': False}),\n",
       " Prediction(uid=100709, iid=2360, r_ui=3.0, est=4.039607508646797, details={'was_impossible': False}),\n",
       " Prediction(uid=53096, iid=1848, r_ui=3.5, est=3.4232447241660866, details={'was_impossible': False}),\n",
       " Prediction(uid=120845, iid=45192, r_ui=4.0, est=3.507170551290127, details={'was_impossible': False}),\n",
       " Prediction(uid=150860, iid=6874, r_ui=4.0, est=3.587797687328107, details={'was_impossible': False}),\n",
       " Prediction(uid=18500, iid=8528, r_ui=3.0, est=3.264863481707598, details={'was_impossible': False}),\n",
       " Prediction(uid=162368, iid=2791, r_ui=4.0, est=3.7494913706147823, details={'was_impossible': False}),\n",
       " Prediction(uid=71146, iid=1687, r_ui=4.0, est=2.99071650878025, details={'was_impossible': False}),\n",
       " Prediction(uid=52564, iid=4886, r_ui=5.0, est=3.7442345487233855, details={'was_impossible': False}),\n",
       " Prediction(uid=56801, iid=6936, r_ui=4.0, est=3.5030247014102778, details={'was_impossible': False}),\n",
       " Prediction(uid=28245, iid=2111, r_ui=3.5, est=3.3550700907031055, details={'was_impossible': False}),\n",
       " Prediction(uid=38196, iid=7346, r_ui=5.0, est=3.463864312727818, details={'was_impossible': False}),\n",
       " Prediction(uid=98436, iid=5418, r_ui=4.0, est=3.978061467794955, details={'was_impossible': False}),\n",
       " Prediction(uid=41471, iid=1918, r_ui=3.0, est=2.9017441104294392, details={'was_impossible': False}),\n",
       " Prediction(uid=145456, iid=52, r_ui=4.0, est=3.4261713189332528, details={'was_impossible': False}),\n",
       " Prediction(uid=62234, iid=27773, r_ui=5.0, est=4.394210507076001, details={'was_impossible': False}),\n",
       " Prediction(uid=5629, iid=2581, r_ui=2.0, est=3.1516617626224175, details={'was_impossible': False}),\n",
       " Prediction(uid=88782, iid=434, r_ui=4.0, est=3.0368777363838966, details={'was_impossible': False}),\n",
       " Prediction(uid=60813, iid=8772, r_ui=3.5, est=3.584114875966861, details={'was_impossible': False}),\n",
       " Prediction(uid=24227, iid=5378, r_ui=3.0, est=3.4632421749144107, details={'was_impossible': False}),\n",
       " Prediction(uid=114156, iid=79132, r_ui=5.0, est=4.065603304795347, details={'was_impossible': False}),\n",
       " Prediction(uid=107583, iid=1285, r_ui=4.0, est=3.771280447582298, details={'was_impossible': False}),\n",
       " Prediction(uid=113894, iid=440, r_ui=4.5, est=3.600563659288188, details={'was_impossible': False}),\n",
       " Prediction(uid=47493, iid=329, r_ui=1.0, est=3.5168433420679075, details={'was_impossible': False}),\n",
       " Prediction(uid=7636, iid=595, r_ui=4.0, est=3.659330464770002, details={'was_impossible': False}),\n",
       " Prediction(uid=53531, iid=1569, r_ui=3.0, est=3.3396265450533567, details={'was_impossible': False}),\n",
       " Prediction(uid=39057, iid=45662, r_ui=3.0, est=3.2064023904272867, details={'was_impossible': False}),\n",
       " Prediction(uid=117030, iid=2701, r_ui=3.5, est=2.3860673756185418, details={'was_impossible': False}),\n",
       " Prediction(uid=143759, iid=71252, r_ui=3.5, est=3.3055876979948424, details={'was_impossible': False}),\n",
       " Prediction(uid=84543, iid=1961, r_ui=3.0, est=3.765841459573295, details={'was_impossible': False}),\n",
       " Prediction(uid=112761, iid=541, r_ui=5.0, est=4.024877134296434, details={'was_impossible': False}),\n",
       " Prediction(uid=82470, iid=357, r_ui=4.0, est=3.488626773063525, details={'was_impossible': False}),\n",
       " Prediction(uid=142538, iid=480, r_ui=4.0, est=3.403854462892503, details={'was_impossible': False}),\n",
       " Prediction(uid=75559, iid=2671, r_ui=4.0, est=3.3818690293599674, details={'was_impossible': False}),\n",
       " Prediction(uid=16954, iid=4369, r_ui=3.5, est=3.1169599127646053, details={'was_impossible': False}),\n",
       " Prediction(uid=69153, iid=48516, r_ui=3.5, est=3.963077999999232, details={'was_impossible': False}),\n",
       " Prediction(uid=20580, iid=7720, r_ui=2.0, est=3.4188080538201073, details={'was_impossible': False}),\n",
       " Prediction(uid=130561, iid=3702, r_ui=3.0, est=3.427211868772844, details={'was_impossible': False}),\n",
       " Prediction(uid=116244, iid=527, r_ui=3.5, est=4.040323950259012, details={'was_impossible': False}),\n",
       " Prediction(uid=92047, iid=130490, r_ui=3.0, est=3.389657596653074, details={'was_impossible': False}),\n",
       " Prediction(uid=107626, iid=91529, r_ui=4.0, est=3.8236185274460373, details={'was_impossible': False}),\n",
       " Prediction(uid=65783, iid=69481, r_ui=4.5, est=3.839231298464652, details={'was_impossible': False}),\n",
       " Prediction(uid=227, iid=1197, r_ui=4.0, est=3.937931047585252, details={'was_impossible': False}),\n",
       " Prediction(uid=147810, iid=2299, r_ui=3.0, est=3.2947684151159664, details={'was_impossible': False}),\n",
       " Prediction(uid=130336, iid=4304, r_ui=2.0, est=3.424349844361868, details={'was_impossible': False}),\n",
       " Prediction(uid=86494, iid=122886, r_ui=3.0, est=3.388985242918875, details={'was_impossible': False}),\n",
       " Prediction(uid=134451, iid=2094, r_ui=3.5, est=3.3091751636580375, details={'was_impossible': False}),\n",
       " Prediction(uid=59969, iid=1285, r_ui=4.0, est=3.3557093454923606, details={'was_impossible': False}),\n",
       " Prediction(uid=66664, iid=1729, r_ui=4.0, est=3.681471790845447, details={'was_impossible': False}),\n",
       " Prediction(uid=68143, iid=8917, r_ui=4.0, est=3.468606255610988, details={'was_impossible': False}),\n",
       " Prediction(uid=52353, iid=1968, r_ui=4.0, est=3.930028217772978, details={'was_impossible': False}),\n",
       " Prediction(uid=48115, iid=1211, r_ui=5.0, est=3.6525383337229154, details={'was_impossible': False}),\n",
       " Prediction(uid=108246, iid=2572, r_ui=1.5, est=3.4990455491955776, details={'was_impossible': False}),\n",
       " Prediction(uid=41134, iid=253, r_ui=3.0, est=3.4438739547484083, details={'was_impossible': False}),\n",
       " Prediction(uid=35437, iid=1347, r_ui=4.0, est=3.3597814711138176, details={'was_impossible': False}),\n",
       " Prediction(uid=121448, iid=778, r_ui=4.0, est=3.975620746696938, details={'was_impossible': False}),\n",
       " Prediction(uid=61021, iid=4310, r_ui=2.0, est=2.680296560317232, details={'was_impossible': False}),\n",
       " Prediction(uid=65651, iid=47, r_ui=5.0, est=4.036230977809666, details={'was_impossible': False}),\n",
       " Prediction(uid=118258, iid=3435, r_ui=5.0, est=4.11891732771336, details={'was_impossible': False}),\n",
       " Prediction(uid=6083, iid=6333, r_ui=3.0, est=3.5132170851168256, details={'was_impossible': False}),\n",
       " Prediction(uid=97390, iid=16, r_ui=4.5, est=3.8227597242571307, details={'was_impossible': False}),\n",
       " Prediction(uid=119043, iid=2161, r_ui=4.0, est=2.8486531657265033, details={'was_impossible': False}),\n",
       " Prediction(uid=121773, iid=91542, r_ui=4.0, est=3.390277463639763, details={'was_impossible': False}),\n",
       " Prediction(uid=105059, iid=1265, r_ui=3.5, est=3.693366752014968, details={'was_impossible': False}),\n",
       " Prediction(uid=27564, iid=3253, r_ui=4.0, est=3.539899750722672, details={'was_impossible': False}),\n",
       " Prediction(uid=25854, iid=653, r_ui=4.5, est=3.306164400002099, details={'was_impossible': False}),\n",
       " Prediction(uid=108665, iid=4787, r_ui=3.5, est=3.294711650158993, details={'was_impossible': False}),\n",
       " Prediction(uid=83924, iid=7254, r_ui=3.5, est=3.6925598489086418, details={'was_impossible': False}),\n",
       " Prediction(uid=44641, iid=2580, r_ui=3.0, est=3.521963521792903, details={'was_impossible': False}),\n",
       " Prediction(uid=104743, iid=2040, r_ui=5.0, est=3.5970440744433874, details={'was_impossible': False}),\n",
       " Prediction(uid=155928, iid=196, r_ui=0.5, est=2.889927993532801, details={'was_impossible': False}),\n",
       " Prediction(uid=36658, iid=1500, r_ui=3.5, est=3.759238451481718, details={'was_impossible': False}),\n",
       " Prediction(uid=11162, iid=4308, r_ui=2.5, est=3.6007821408038483, details={'was_impossible': False}),\n",
       " Prediction(uid=162124, iid=1036, r_ui=3.5, est=3.88149415448569, details={'was_impossible': False}),\n",
       " Prediction(uid=83035, iid=5040, r_ui=3.5, est=3.281370617912249, details={'was_impossible': False}),\n",
       " Prediction(uid=120107, iid=2968, r_ui=3.0, est=3.87770986683148, details={'was_impossible': False}),\n",
       " Prediction(uid=2634, iid=40278, r_ui=2.5, est=3.242050276975439, details={'was_impossible': False}),\n",
       " Prediction(uid=41908, iid=2858, r_ui=4.0, est=3.7451113189455643, details={'was_impossible': False}),\n",
       " Prediction(uid=158937, iid=140956, r_ui=4.0, est=3.3529065044558535, details={'was_impossible': False}),\n",
       " Prediction(uid=64144, iid=1907, r_ui=5.0, est=3.634389957393018, details={'was_impossible': False}),\n",
       " Prediction(uid=145631, iid=784, r_ui=3.0, est=3.1740346980885565, details={'was_impossible': False}),\n",
       " Prediction(uid=30879, iid=1276, r_ui=3.0, est=3.4593138122584244, details={'was_impossible': False}),\n",
       " Prediction(uid=71334, iid=1265, r_ui=4.0, est=3.7932466896455246, details={'was_impossible': False}),\n",
       " Prediction(uid=153055, iid=4270, r_ui=3.0, est=3.306257938398665, details={'was_impossible': False}),\n",
       " Prediction(uid=136949, iid=7000, r_ui=2.5, est=3.097309659636497, details={'was_impossible': False}),\n",
       " Prediction(uid=146348, iid=56156, r_ui=1.0, est=3.3213476942411404, details={'was_impossible': False}),\n",
       " Prediction(uid=107564, iid=736, r_ui=1.0, est=3.3818907675650483, details={'was_impossible': False}),\n",
       " Prediction(uid=144928, iid=160223, r_ui=3.0, est=3.3243027742572058, details={'was_impossible': False}),\n",
       " Prediction(uid=7409, iid=253, r_ui=4.0, est=3.3981130300163223, details={'was_impossible': False}),\n",
       " Prediction(uid=28914, iid=89, r_ui=3.0, est=3.2200342052229463, details={'was_impossible': False}),\n",
       " Prediction(uid=155831, iid=2918, r_ui=3.0, est=3.7935730260807774, details={'was_impossible': False}),\n",
       " Prediction(uid=115002, iid=36, r_ui=5.0, est=3.8858231002793113, details={'was_impossible': False}),\n",
       " Prediction(uid=128213, iid=2394, r_ui=2.0, est=3.7538379585679835, details={'was_impossible': False}),\n",
       " Prediction(uid=110525, iid=3684, r_ui=3.0, est=3.962002676484659, details={'was_impossible': False}),\n",
       " Prediction(uid=141385, iid=6, r_ui=5.0, est=3.5691018499458393, details={'was_impossible': False}),\n",
       " Prediction(uid=94608, iid=4262, r_ui=3.0, est=3.580621897637152, details={'was_impossible': False}),\n",
       " Prediction(uid=72925, iid=1258, r_ui=1.0, est=4.3087866159741655, details={'was_impossible': False}),\n",
       " Prediction(uid=13220, iid=218, r_ui=5.0, est=3.584393609784502, details={'was_impossible': False}),\n",
       " Prediction(uid=15801, iid=329, r_ui=4.0, est=3.5168433420679075, details={'was_impossible': False}),\n",
       " Prediction(uid=72211, iid=2022, r_ui=3.5, est=3.571169656124535, details={'was_impossible': False}),\n",
       " Prediction(uid=98477, iid=89470, r_ui=4.5, est=3.628043547210568, details={'was_impossible': False}),\n",
       " Prediction(uid=2665, iid=5791, r_ui=4.0, est=3.78004233368843, details={'was_impossible': False}),\n",
       " Prediction(uid=130538, iid=593, r_ui=4.0, est=4.122130146945847, details={'was_impossible': False}),\n",
       " Prediction(uid=23624, iid=356, r_ui=3.0, est=3.8748653707619605, details={'was_impossible': False}),\n",
       " Prediction(uid=48153, iid=934, r_ui=4.0, est=3.4455378240408736, details={'was_impossible': False}),\n",
       " Prediction(uid=13699, iid=4848, r_ui=4.0, est=3.964510485054583, details={'was_impossible': False}),\n",
       " Prediction(uid=150873, iid=1985, r_ui=1.0, est=2.9894941042206242, details={'was_impossible': False}),\n",
       " Prediction(uid=59867, iid=296, r_ui=2.0, est=3.9046172153780203, details={'was_impossible': False}),\n",
       " Prediction(uid=140712, iid=515, r_ui=5.0, est=3.794265706120707, details={'was_impossible': False}),\n",
       " Prediction(uid=55619, iid=2416, r_ui=2.0, est=3.2789400342888233, details={'was_impossible': False}),\n",
       " Prediction(uid=44562, iid=3173, r_ui=1.0, est=3.6609841553935842, details={'was_impossible': False}),\n",
       " Prediction(uid=34409, iid=48304, r_ui=5.0, est=3.841531864681526, details={'was_impossible': False}),\n",
       " Prediction(uid=147954, iid=142488, r_ui=2.5, est=3.97668325187471, details={'was_impossible': False}),\n",
       " Prediction(uid=133207, iid=1835, r_ui=3.0, est=3.7164463667973915, details={'was_impossible': False}),\n",
       " Prediction(uid=9811, iid=164179, r_ui=4.0, est=4.1711259705932235, details={'was_impossible': False}),\n",
       " Prediction(uid=34383, iid=5618, r_ui=5.0, est=3.9302156428134105, details={'was_impossible': False}),\n",
       " Prediction(uid=79110, iid=595, r_ui=5.0, est=3.659330464770002, details={'was_impossible': False}),\n",
       " Prediction(uid=109804, iid=4144, r_ui=3.5, est=3.753351222763842, details={'was_impossible': False}),\n",
       " Prediction(uid=18078, iid=4461, r_ui=2.5, est=3.536546029712464, details={'was_impossible': False}),\n",
       " Prediction(uid=31631, iid=54286, r_ui=3.0, est=3.822379749291095, details={'was_impossible': False}),\n",
       " Prediction(uid=64716, iid=30793, r_ui=1.0, est=3.4798291282064815, details={'was_impossible': False}),\n",
       " Prediction(uid=9578, iid=1358, r_ui=3.5, est=3.928081949721927, details={'was_impossible': False}),\n",
       " Prediction(uid=139175, iid=2167, r_ui=5.0, est=2.977479597961226, details={'was_impossible': False}),\n",
       " Prediction(uid=9835, iid=5943, r_ui=4.0, est=2.572438031253931, details={'was_impossible': False}),\n",
       " Prediction(uid=91614, iid=37382, r_ui=2.5, est=3.4183861079480846, details={'was_impossible': False}),\n",
       " Prediction(uid=14339, iid=953, r_ui=5.0, est=4.179126844484675, details={'was_impossible': False}),\n",
       " Prediction(uid=95886, iid=3972, r_ui=4.0, est=3.5659305146178846, details={'was_impossible': False}),\n",
       " Prediction(uid=139102, iid=24, r_ui=3.0, est=3.0464374702149555, details={'was_impossible': False}),\n",
       " Prediction(uid=158767, iid=344, r_ui=1.0, est=3.151890091902908, details={'was_impossible': False}),\n",
       " Prediction(uid=52039, iid=70, r_ui=4.5, est=3.4817585041840453, details={'was_impossible': False}),\n",
       " Prediction(uid=82410, iid=4110, r_ui=3.5, est=3.5904423910822674, details={'was_impossible': False}),\n",
       " Prediction(uid=124624, iid=1225, r_ui=4.0, est=4.24538307619418, details={'was_impossible': False}),\n",
       " Prediction(uid=15763, iid=1019, r_ui=3.0, est=3.570102296807156, details={'was_impossible': False}),\n",
       " Prediction(uid=44858, iid=1704, r_ui=3.5, est=3.8952752797592805, details={'was_impossible': False}),\n",
       " Prediction(uid=133921, iid=33126, r_ui=2.5, est=3.573057262000024, details={'was_impossible': False}),\n",
       " Prediction(uid=78807, iid=8371, r_ui=4.5, est=3.08210355472366, details={'was_impossible': False}),\n",
       " Prediction(uid=29772, iid=1441, r_ui=3.0, est=3.8012985803038077, details={'was_impossible': False}),\n",
       " Prediction(uid=95804, iid=296, r_ui=2.0, est=3.9046172153780203, details={'was_impossible': False}),\n",
       " Prediction(uid=68230, iid=8368, r_ui=3.5, est=3.627335678403966, details={'was_impossible': False}),\n",
       " Prediction(uid=68741, iid=7482, r_ui=4.0, est=3.324129404081191, details={'was_impossible': False}),\n",
       " Prediction(uid=5268, iid=494, r_ui=3.0, est=3.3144060965482836, details={'was_impossible': False}),\n",
       " Prediction(uid=97800, iid=39183, r_ui=5.0, est=3.7606075739659968, details={'was_impossible': False}),\n",
       " Prediction(uid=121259, iid=93510, r_ui=4.0, est=4.203342181559636, details={'was_impossible': False}),\n",
       " Prediction(uid=111258, iid=37741, r_ui=3.5, est=4.016153037557554, details={'was_impossible': False}),\n",
       " Prediction(uid=25376, iid=1965, r_ui=4.0, est=3.709034198163267, details={'was_impossible': False}),\n",
       " Prediction(uid=144482, iid=3261, r_ui=4.0, est=3.567907208465235, details={'was_impossible': False}),\n",
       " Prediction(uid=105543, iid=1732, r_ui=3.5, est=3.9635546322286888, details={'was_impossible': False}),\n",
       " Prediction(uid=107798, iid=292, r_ui=4.0, est=3.4500939281751126, details={'was_impossible': False}),\n",
       " Prediction(uid=161160, iid=216, r_ui=1.0, est=3.1672213856319713, details={'was_impossible': False}),\n",
       " Prediction(uid=25513, iid=90528, r_ui=3.5, est=3.41310437659789, details={'was_impossible': False}),\n",
       " Prediction(uid=64893, iid=60684, r_ui=4.0, est=3.76465645557579, details={'was_impossible': False}),\n",
       " Prediction(uid=52338, iid=2126, r_ui=4.0, est=2.9624242202446167, details={'was_impossible': False}),\n",
       " Prediction(uid=135630, iid=68954, r_ui=5.0, est=3.7280855071139025, details={'was_impossible': False}),\n",
       " Prediction(uid=53920, iid=6163, r_ui=0.5, est=3.535214285714286, details={'was_impossible': False}),\n",
       " Prediction(uid=119902, iid=2765, r_ui=5.0, est=3.3687583585308545, details={'was_impossible': False}),\n",
       " Prediction(uid=109229, iid=2912, r_ui=4.0, est=3.667999434898895, details={'was_impossible': False}),\n",
       " Prediction(uid=3686, iid=207, r_ui=5.0, est=3.401957029913573, details={'was_impossible': False}),\n",
       " Prediction(uid=79011, iid=185, r_ui=3.0, est=3.439840946085353, details={'was_impossible': False}),\n",
       " Prediction(uid=57947, iid=4246, r_ui=2.5, est=3.646245619528589, details={'was_impossible': False}),\n",
       " Prediction(uid=49222, iid=59709, r_ui=2.0, est=3.2042805497755924, details={'was_impossible': False}),\n",
       " Prediction(uid=102552, iid=4306, r_ui=3.5, est=3.4774679669606203, details={'was_impossible': False}),\n",
       " Prediction(uid=39344, iid=153, r_ui=3.0, est=3.032047406750298, details={'was_impossible': False}),\n",
       " Prediction(uid=94050, iid=3175, r_ui=4.0, est=3.627464254369348, details={'was_impossible': False}),\n",
       " Prediction(uid=115462, iid=55247, r_ui=4.0, est=3.4592859175348454, details={'was_impossible': False}),\n",
       " Prediction(uid=24570, iid=380, r_ui=3.5, est=3.528642892674594, details={'was_impossible': False}),\n",
       " Prediction(uid=68514, iid=8638, r_ui=4.0, est=3.8149468132264546, details={'was_impossible': False}),\n",
       " Prediction(uid=159028, iid=50, r_ui=5.0, est=4.172686906071082, details={'was_impossible': False}),\n",
       " Prediction(uid=22966, iid=364, r_ui=4.0, est=3.73083062009629, details={'was_impossible': False}),\n",
       " Prediction(uid=134187, iid=659, r_ui=3.0, est=3.3792055076339227, details={'was_impossible': False}),\n",
       " Prediction(uid=72239, iid=420, r_ui=4.5, est=2.9544393521976873, details={'was_impossible': False}),\n",
       " Prediction(uid=144476, iid=3072, r_ui=3.5, est=3.627395118021467, details={'was_impossible': False}),\n",
       " Prediction(uid=116518, iid=7619, r_ui=2.5, est=3.070454632758211, details={'was_impossible': False}),\n",
       " Prediction(uid=129464, iid=1196, r_ui=5.0, est=4.032249995925047, details={'was_impossible': False}),\n",
       " Prediction(uid=73040, iid=1537, r_ui=5.0, est=3.4561590872870456, details={'was_impossible': False}),\n",
       " Prediction(uid=49479, iid=1358, r_ui=1.5, est=3.928081949721927, details={'was_impossible': False}),\n",
       " Prediction(uid=96236, iid=2028, r_ui=3.0, est=3.8312525874853467, details={'was_impossible': False}),\n",
       " Prediction(uid=9022, iid=2791, r_ui=3.0, est=2.8514599628759307, details={'was_impossible': False}),\n",
       " Prediction(uid=85709, iid=2413, r_ui=5.0, est=3.213870698776583, details={'was_impossible': False}),\n",
       " Prediction(uid=141748, iid=4008, r_ui=3.5, est=3.3089840627249187, details={'was_impossible': False}),\n",
       " Prediction(uid=28746, iid=2406, r_ui=5.0, est=3.7292251340628244, details={'was_impossible': False}),\n",
       " Prediction(uid=60208, iid=2420, r_ui=4.0, est=3.4839664277756643, details={'was_impossible': False}),\n",
       " Prediction(uid=75764, iid=70286, r_ui=4.0, est=3.8046802285752808, details={'was_impossible': False}),\n",
       " Prediction(uid=155408, iid=5995, r_ui=4.5, est=3.667067996525545, details={'was_impossible': False}),\n",
       " Prediction(uid=101320, iid=1196, r_ui=3.5, est=4.032249995925047, details={'was_impossible': False}),\n",
       " Prediction(uid=66534, iid=333, r_ui=5.0, est=3.568693701597893, details={'was_impossible': False}),\n",
       " Prediction(uid=97693, iid=356, r_ui=4.5, est=3.8748653707619605, details={'was_impossible': False}),\n",
       " Prediction(uid=94154, iid=115149, r_ui=2.0, est=3.3819470506579616, details={'was_impossible': False}),\n",
       " Prediction(uid=116055, iid=7293, r_ui=3.0, est=3.2074817393550794, details={'was_impossible': False}),\n",
       " ...]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predictions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "020b5215",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>uid</th>\n",
       "      <th>iid</th>\n",
       "      <th>r_ui</th>\n",
       "      <th>est</th>\n",
       "      <th>details</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>72210</td>\n",
       "      <td>4361</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.114892</td>\n",
       "      <td>{'was_impossible': False}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>38912</td>\n",
       "      <td>6365</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.405543</td>\n",
       "      <td>{'was_impossible': False}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>95080</td>\n",
       "      <td>1200</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3.999952</td>\n",
       "      <td>{'was_impossible': False}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>52199</td>\n",
       "      <td>48</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.175966</td>\n",
       "      <td>{'was_impossible': False}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>78421</td>\n",
       "      <td>122</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.149097</td>\n",
       "      <td>{'was_impossible': False}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29995</th>\n",
       "      <td>46473</td>\n",
       "      <td>4890</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3.016810</td>\n",
       "      <td>{'was_impossible': False}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29996</th>\n",
       "      <td>112193</td>\n",
       "      <td>71156</td>\n",
       "      <td>4.5</td>\n",
       "      <td>3.450133</td>\n",
       "      <td>{'was_impossible': False}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29997</th>\n",
       "      <td>141829</td>\n",
       "      <td>7078</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.464504</td>\n",
       "      <td>{'was_impossible': False}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29998</th>\n",
       "      <td>82193</td>\n",
       "      <td>266</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.371345</td>\n",
       "      <td>{'was_impossible': False}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29999</th>\n",
       "      <td>140366</td>\n",
       "      <td>106100</td>\n",
       "      <td>4.5</td>\n",
       "      <td>3.902183</td>\n",
       "      <td>{'was_impossible': False}</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>30000 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          uid     iid  r_ui       est                    details\n",
       "0       72210    4361   2.0  3.114892  {'was_impossible': False}\n",
       "1       38912    6365   3.5  3.405543  {'was_impossible': False}\n",
       "2       95080    1200   5.0  3.999952  {'was_impossible': False}\n",
       "3       52199      48   4.0  3.175966  {'was_impossible': False}\n",
       "4       78421     122   3.0  3.149097  {'was_impossible': False}\n",
       "...       ...     ...   ...       ...                        ...\n",
       "29995   46473    4890   5.0  3.016810  {'was_impossible': False}\n",
       "29996  112193   71156   4.5  3.450133  {'was_impossible': False}\n",
       "29997  141829    7078   4.0  3.464504  {'was_impossible': False}\n",
       "29998   82193     266   3.0  3.371345  {'was_impossible': False}\n",
       "29999  140366  106100   4.5  3.902183  {'was_impossible': False}\n",
       "\n",
       "[30000 rows x 5 columns]"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test_pred = pd.DataFrame(predictions, columns=['uid', 'iid', 'r_ui', 'est', 'details'])\n",
    "df_test_pred"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "cf26d7f9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "       userID  movieID    rating\n",
      "2087   145873      318  4.984627\n",
      "4101    59996      318  4.860397\n",
      "14366   87551      318  4.795323\n",
      "22348   75309      974  4.751974\n",
      "26469   75309   134935  4.723607\n",
      "...       ...      ...       ...\n",
      "1000    49403     5255  1.609197\n",
      "21802   49403      784  1.554012\n",
      "29685  109210     1429  1.339899\n",
      "17934  109210   108255  1.299303\n",
      "11821  109210     3444  1.088030\n",
      "\n",
      "[29803 rows x 3 columns]\n"
     ]
    }
   ],
   "source": [
    "# Convert the predictions list to a pandas dataframe\n",
    "df_test_pred = df_test_pred.rename(columns={'uid': 'userID', 'iid': 'movieID', 'r_ui': ' true rating', 'est': 'rating'})\n",
    "\n",
    "# Sort the dataframe by estimated rating in descending order\n",
    "df_test_pred = df_test_pred.sort_values(by='rating', ascending=False)\n",
    "\n",
    "# Group the dataframe by user id and get the top-rated item for each user\n",
    "top_n = df_test_pred.groupby('userID').head()\n",
    "\n",
    "# Print the top-rated item for each user\n",
    "print(top_n[['userID', 'movieID', 'rating']])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "26f620b5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(30000, 5)"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test_pred.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "74d45ce5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "userID          0\n",
       "movieID         0\n",
       " true rating    0\n",
       "rating          0\n",
       "details         0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test_pred.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "0eb02fd0",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create the final prediction by concatenating the Id and rating columns\n",
    "final_pred = pd.concat([test_df['Id'], df_test_pred['rating']], axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "eb9fd1c8",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Save the final prediction as a CSV file\n",
    "final_pred.to_csv('final_prediction.csv', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "fd7e622e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "4970019\n"
     ]
    }
   ],
   "source": [
    "print(final_pred['rating'].isnull().sum())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "b78532bb",
   "metadata": {},
   "outputs": [],
   "source": [
    "final_pred['rating'] = final_pred['rating'].fillna(final_pred['rating'].mean())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "d384a1ac",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Save the final prediction as a CSV file\n",
    "final_pred.to_csv('final_prediction.csv', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "274a4f7c",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
